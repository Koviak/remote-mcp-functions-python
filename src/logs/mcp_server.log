 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T09:00:41 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T09:01:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:02:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:02:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 681 seconds, refreshing...
2025-10-02T09:02:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T09:03:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:04:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:05:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:06:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:07:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:07:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 381 seconds, refreshing...
2025-10-02T09:07:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T09:08:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:09:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:10:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:10:42 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T09:10:42 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T09:11:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:12:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:13:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:13:05 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T09:13:06 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6e35661a-a5cd-4d07-a9d2-bce8e4793200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 14:13:06 GMT'
    'Content-Length': '1753'
2025-10-02T09:13:06 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T09:13:06 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '74cb5c6d-5c9a-4f18-9b54-679da5240800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 14:13:06 GMT'
    'Content-Length': '7944'
2025-10-02T09:13:06 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T09:13:06 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T09:13:07 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T09:13:07 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T09:13:07 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T14:13:08","request-id":"861c21e9-ce86-4d47-80b5-6e1f6df8a38d","client-request-id":"861c21e9-ce86-4d47-80b5-6e1f6df8a38d
2025-10-02T09:13:07 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T09:13:07 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T09:13:07 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T14:13:08","request-id":"3f592328-8f2e-4d6d-90de-95d4f2df5770","client-request-id":"3f592328-8f2e-4d6d-90de-95d4f2df5770
2025-10-02T09:13:07 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T09:13:07 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T09:13:07 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T09:13:07 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T09:13:07 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T09:13:07 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T09:13:10 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T09:13:10 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T09:13:10 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T09:13:29 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T09:13:29 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T09:14:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:14:28 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T09:14:29 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T09:15:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:16:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:17:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:18:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:19:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:20:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:21:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:22:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:23:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:24:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:25:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:26:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:27:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:28:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:29:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:30:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:31:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:32:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:33:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:34:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:35:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:36:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:37:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:38:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:39:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:39:35 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T09:39:36 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: fae8be1b-b985-4177-8012-61926556420d, function type: sync, timestamp (UTC): 2025-10-02 14:39:36.207611, sync threadpool max workers: 1000
2025-10-02T09:39:36 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T09:39:36 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T09:39:36 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T09:40:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:41:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:42:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:43:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:44:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:45:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:46:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:46:16 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 85541999-669e-4676-91b4-3774c76d2ad4, function type: sync, timestamp (UTC): 2025-10-02 14:46:16.134414, sync threadpool max workers: 1000
2025-10-02T09:46:16 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T09:46:16 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T09:47:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:48:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:49:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:50:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:50:43 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: e3c09968-fb5c-4568-87a5-a8f25b926339, function type: sync, timestamp (UTC): 2025-10-02 14:50:43.023275, sync threadpool max workers: 1000
2025-10-02T09:50:43 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T09:50:48 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T09:51:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:52:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:52:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 645 seconds, refreshing...
2025-10-02T09:52:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T09:53:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:54:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:55:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:56:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:57:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:57:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 345 seconds, refreshing...
2025-10-02T09:57:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T09:58:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T09:59:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:00:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:01:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:02:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:03:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:04:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:05:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:06:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:07:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:08:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:09:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:10:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:11:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:12:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:13:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:14:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:14:28 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T10:14:28 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '05fb1539-9ba1-429d-9fba-52b913460000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 15:14:29 GMT'
    'Content-Length': '1753'
2025-10-02T10:14:28 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T10:14:29 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '5c794cc0-1cd5-4496-88fb-f177ac340b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 15:14:29 GMT'
    'Content-Length': '7944'
2025-10-02T10:14:29 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T10:14:29 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T10:14:30 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T10:14:30 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T10:14:30 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T15:14:31","request-id":"e5b003d2-3a7e-472c-adbb-87ab209f7b73","client-request-id":"e5b003d2-3a7e-472c-adbb-87ab209f7b73
2025-10-02T10:14:30 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T10:14:30 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T10:14:30 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T15:14:31","request-id":"93145625-9f66-476f-a8ba-3bcbf5397e74","client-request-id":"93145625-9f66-476f-a8ba-3bcbf5397e74
2025-10-02T10:14:30 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T10:14:30 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T10:14:30 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T10:14:30 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T10:14:30 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T10:14:30 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T10:14:32 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T10:14:32 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T10:14:32 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T10:14:57 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T10:14:57 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T10:15:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:15:54 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T10:15:56 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T10:16:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:17:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:18:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:19:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:20:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:21:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:22:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:22:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 825 seconds, refreshing...
2025-10-02T10:22:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T10:23:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:24:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:25:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:26:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:27:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:27:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 525 seconds, refreshing...
2025-10-02T10:27:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T10:28:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:29:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:30:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:31:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:32:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:33:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:34:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:35:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:36:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:36:13 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a5c0a189-d416-47fa-844a-61d6c99965a4, function type: sync, timestamp (UTC): 2025-10-02 15:36:13.867890, sync threadpool max workers: 1000
2025-10-02T10:36:13 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T10:36:13 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-02T10:36:13 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T10:37:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:38:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:39:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:39:36 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T10:39:37 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T10:39:37 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T10:39:37 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 9a5efb59-24cc-4404-a110-53c0a042e22d, function type: sync, timestamp (UTC): 2025-10-02 15:39:37.923351, sync threadpool max workers: 1000
2025-10-02T10:39:37 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T10:39:38 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T10:39:38 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T10:40:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:40:49 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a2bdbfd1-0426-4e69-8962-d626c57ea732, function type: sync, timestamp (UTC): 2025-10-02 15:40:49.500806, sync threadpool max workers: 1000
2025-10-02T10:40:49 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T10:40:55 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T10:41:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:42:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:43:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:44:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:45:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:46:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:47:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:48:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:49:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:50:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:51:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:52:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:52:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 728 seconds, refreshing...
2025-10-02T10:52:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T10:53:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:54:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:55:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:56:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:57:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:57:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 428 seconds, refreshing...
2025-10-02T10:57:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T10:58:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T10:59:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:00:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:01:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:02:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:03:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:04:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:05:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:06:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:07:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:08:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:09:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:10:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:11:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:12:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:13:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:14:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:15:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:15:54 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T11:15:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '996d4568-77d5-4560-aaad-df57006a0000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 16:15:55 GMT'
    'Content-Length': '1753'
2025-10-02T11:15:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T11:15:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b91baa00-8230-4e96-ada0-f5d6dc3d0b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 16:15:55 GMT'
    'Content-Length': '7944'
2025-10-02T11:15:55 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T11:15:55 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T11:15:56 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T11:15:56 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T11:15:57 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T16:15:57","request-id":"ede6aef3-f5b2-453c-86fc-2aee6083f0bf","client-request-id":"ede6aef3-f5b2-453c-86fc-2aee6083f0bf
2025-10-02T11:15:57 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T11:15:57 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T11:15:57 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T16:15:57","request-id":"d629b582-8a1b-445f-92db-493f1461119e","client-request-id":"d629b582-8a1b-445f-92db-493f1461119e
2025-10-02T11:15:57 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T11:15:57 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T11:15:57 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T11:15:57 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T11:15:57 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T11:15:57 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T11:15:59 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T11:15:59 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T11:15:59 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T11:16:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:16:18 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T11:16:18 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T11:17:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:17:15 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T11:17:16 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T11:18:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:19:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:20:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:21:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:22:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:23:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:24:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:25:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:26:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:26:24 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: cdb98b5b-5042-4f69-b34c-91680ae60a8f, function type: sync, timestamp (UTC): 2025-10-02 16:26:24.932494, sync threadpool max workers: 1000
2025-10-02T11:26:24 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T11:26:24 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T11:27:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:28:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:29:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:30:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:30:56 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 715f490f-6b69-48a3-858e-220699aed339, function type: sync, timestamp (UTC): 2025-10-02 16:30:56.741738, sync threadpool max workers: 1000
2025-10-02T11:30:56 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T11:31:03 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T11:31:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:32:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:33:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:34:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:35:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:36:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:37:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:37:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 843 seconds, refreshing...
2025-10-02T11:37:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T11:38:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:39:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:39:38 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T11:39:39 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 195a3cd6-a6ba-4bac-a6d8-08ea55892683, function type: sync, timestamp (UTC): 2025-10-02 16:39:39.497736, sync threadpool max workers: 1000
2025-10-02T11:39:39 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T11:39:39 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T11:39:39 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T11:40:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:41:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:42:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:42:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 543 seconds, refreshing...
2025-10-02T11:42:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T11:43:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:44:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:45:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:46:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:47:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:48:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:49:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:50:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:51:04 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T11:51:04 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T11:51:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:52:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:52:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 814 seconds, refreshing...
2025-10-02T11:52:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T11:53:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:54:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:55:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:56:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:57:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:57:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 514 seconds, refreshing...
2025-10-02T11:57:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T11:58:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T11:59:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:00:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:01:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:02:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:03:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:04:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:05:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:06:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:07:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:08:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:09:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:10:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:11:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:12:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:13:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:14:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:15:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:16:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:16:46 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a0583a22-e7ad-4c8a-81ee-5e26dd9ee787, function type: sync, timestamp (UTC): 2025-10-02 17:16:46.716881, sync threadpool max workers: 1000
2025-10-02T12:16:46 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T12:16:46 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-02T12:16:46 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T12:17:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:17:15 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T12:17:16 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '83d90012-05de-4a12-8630-42f1ca260d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 17:17:15 GMT'
    'Content-Length': '1753'
2025-10-02T12:17:16 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T12:17:16 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '83d90012-05de-4a12-8630-42f1d0260d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 17:17:16 GMT'
    'Content-Length': '7943'
2025-10-02T12:17:16 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T12:17:16 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T12:17:18 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T12:17:18 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T12:17:18 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T17:17:19","request-id":"b870d4df-eb77-4bb1-8cb5-d7cd697ac8bc","client-request-id":"b870d4df-eb77-4bb1-8cb5-d7cd697ac8bc
2025-10-02T12:17:18 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T12:17:18 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T12:17:18 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T17:17:19","request-id":"5f960d5f-ad51-408c-ba60-0f53fac92510","client-request-id":"5f960d5f-ad51-408c-ba60-0f53fac92510
2025-10-02T12:17:18 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T12:17:18 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T12:17:18 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T12:17:18 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T12:17:18 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T12:17:18 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T12:17:21 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T12:17:21 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T12:17:21 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T12:17:49 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T12:17:49 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T12:18:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:19:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:19:17 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T12:19:17 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T12:20:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:21:05 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 3cd445af-b8e5-44a9-98a0-c1afaeffdf27, function type: sync, timestamp (UTC): 2025-10-02 17:21:05.137008, sync threadpool max workers: 1000
2025-10-02T12:21:05 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T12:21:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:21:10 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T12:22:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:23:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:24:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:25:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:26:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:27:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:28:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:29:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:30:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:31:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:32:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:33:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:34:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:35:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:36:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:37:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:38:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:39:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:39:39 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T12:39:40 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: c00f6d7e-737a-4bc3-9cdd-e5120b52285b, function type: sync, timestamp (UTC): 2025-10-02 17:39:40.648365, sync threadpool max workers: 1000
2025-10-02T12:39:40 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T12:39:40 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T12:39:40 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T12:40:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:41:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:42:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:43:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:44:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:45:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:46:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:47:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:48:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:49:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:50:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:51:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:52:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:52:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 895 seconds, refreshing...
2025-10-02T12:52:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T12:53:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:54:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:55:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:56:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:57:10 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:57:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 595 seconds, refreshing...
2025-10-02T12:57:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T12:57:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 610 seconds, refreshing...
2025-10-02T12:57:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T12:58:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T12:59:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:00:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:01:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:02:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:02:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 310 seconds, refreshing...
2025-10-02T13:02:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T13:03:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:04:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:05:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:06:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:06:42 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 204808f2-dd98-4448-8cff-9523c7b4a529, function type: sync, timestamp (UTC): 2025-10-02 18:06:42.521924, sync threadpool max workers: 1000
2025-10-02T13:06:42 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T13:06:42 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T13:07:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:08:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:09:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:10:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:11:11 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T13:11:11 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T13:11:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:11:12 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 1eed627b-f16c-4661-9e41-f7d081a35e52, function type: sync, timestamp (UTC): 2025-10-02 18:11:12.392140, sync threadpool max workers: 1000
2025-10-02T13:11:12 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T13:11:17 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T13:12:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:13:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:14:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:15:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:16:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:17:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:18:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:19:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:19:17 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T13:19:17 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b738305f-2f25-43a4-ad33-a9d685e13d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 18:19:18 GMT'
    'Content-Length': '1753'
2025-10-02T13:19:17 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T13:19:17 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '39ad757a-caf2-4ffe-a09d-b8e7fbc70d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 18:19:18 GMT'
    'Content-Length': '7943'
2025-10-02T13:19:17 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T13:19:17 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T13:19:19 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T13:19:19 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T13:19:19 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T18:19:20","request-id":"cdbf5018-1e45-4b00-b894-9e82fce085b4","client-request-id":"cdbf5018-1e45-4b00-b894-9e82fce085b4
2025-10-02T13:19:19 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T13:19:19 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T13:19:19 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T18:19:20","request-id":"68618e2c-b38c-4c31-abb7-d7dd8e9f716e","client-request-id":"68618e2c-b38c-4c31-abb7-d7dd8e9f716e
2025-10-02T13:19:19 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T13:19:19 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T13:19:19 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T13:19:19 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T13:19:19 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T13:19:19 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T13:19:23 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T13:19:23 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T13:19:23 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T13:19:54 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T13:19:54 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T13:20:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:21:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:21:26 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T13:21:27 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T13:22:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:23:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:24:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:25:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:26:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:27:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:28:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:29:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:30:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:31:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:32:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:33:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:34:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:35:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:36:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:37:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:38:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:39:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:39:40 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T13:39:41 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 6837b912-b03d-4268-94e6-94593d034602, function type: sync, timestamp (UTC): 2025-10-02 18:39:41.753236, sync threadpool max workers: 1000
2025-10-02T13:39:41 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T13:39:42 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T13:39:42 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T13:40:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:41:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:42:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:43:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:44:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:45:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:46:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:47:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:48:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:49:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:50:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:51:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:52:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:53:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:54:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:55:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:56:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:56:47 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 71c974a2-b4e1-4494-83f1-1051e06d7407, function type: sync, timestamp (UTC): 2025-10-02 18:56:47.497560, sync threadpool max workers: 1000
2025-10-02T13:56:47 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T13:56:47 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-02T13:56:47 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T13:57:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:57:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 716 seconds, refreshing...
2025-10-02T13:57:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T13:58:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T13:59:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:00:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:01:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:01:20 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 39a2ac56-1bfb-4ad9-b6b6-a96b7ff03aec, function type: sync, timestamp (UTC): 2025-10-02 19:01:20.443056, sync threadpool max workers: 1000
2025-10-02T14:01:20 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T14:01:26 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T14:02:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:02:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 416 seconds, refreshing...
2025-10-02T14:02:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T14:03:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:04:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:05:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:06:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:07:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:07:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 657 seconds, refreshing...
2025-10-02T14:07:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T14:08:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:09:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:10:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:11:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:12:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:12:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 357 seconds, refreshing...
2025-10-02T14:12:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T14:13:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:14:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:15:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:16:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:17:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:18:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:19:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:20:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:21:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:21:26 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T14:21:27 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '173a7018-2b70-47cd-9283-1a001f710600'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 19:21:27 GMT'
    'Content-Length': '1753'
2025-10-02T14:21:27 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T14:21:27 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '7986e5f7-caee-4429-bf71-ecf7aaef4200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 19:21:28 GMT'
    'Content-Length': '7943'
2025-10-02T14:21:27 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T14:21:27 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T14:21:30 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T14:21:30 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T14:21:30 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T14:21:30 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T14:21:30 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T19:21:31","request-id":"f74d7c13-aae9-46c0-bb69-afd586c86b42","client-request-id":"f74d7c13-aae9-46c0-bb69-afd586c86b42
2025-10-02T14:21:30 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T14:21:30 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T14:21:30 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T19:21:31","request-id":"3e194bae-1777-48c9-a77d-d875eb5931a2","client-request-id":"3e194bae-1777-48c9-a77d-d875eb5931a2
2025-10-02T14:21:30 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T14:21:30 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T14:21:30 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T14:21:30 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T14:21:30 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T14:21:30 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T14:21:33 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T14:21:33 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T14:21:33 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T14:22:01 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T14:22:01 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T14:22:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:23:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:23:31 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T14:23:32 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T14:24:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:25:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:26:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:27:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:28:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:29:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:30:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:31:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:32:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:33:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:34:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:35:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:36:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:37:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:38:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:39:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:39:42 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T14:39:42 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a659e54c-5bb3-4f7a-9173-cd8d870839e7, function type: sync, timestamp (UTC): 2025-10-02 19:39:42.842164, sync threadpool max workers: 1000
2025-10-02T14:39:42 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T14:39:43 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T14:39:43 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T14:40:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:41:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:42:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:43:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:44:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:45:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:46:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:47:06 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: bacd8767-b44c-4ab6-9e25-36e6b37a5cf2, function type: sync, timestamp (UTC): 2025-10-02 19:47:06.180318, sync threadpool max workers: 1000
2025-10-02T14:47:06 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T14:47:06 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T14:47:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:48:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:49:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:50:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:51:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:51:34 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 28c56e61-eabc-4f75-a3c0-f54915a609c7, function type: sync, timestamp (UTC): 2025-10-02 19:51:34.520165, sync threadpool max workers: 1000
2025-10-02T14:51:34 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T14:51:40 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T14:52:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:53:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:54:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:55:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:56:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:57:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:57:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 846 seconds, refreshing...
2025-10-02T14:57:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T14:58:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T14:59:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:00:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:01:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:02:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:02:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 546 seconds, refreshing...
2025-10-02T15:02:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T15:03:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:04:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:05:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:06:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:07:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:08:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:09:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:10:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:11:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:12:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:13:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:14:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:15:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:16:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:17:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:18:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:19:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:20:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:21:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:22:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:22:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 783 seconds, refreshing...
2025-10-02T15:22:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T15:23:18 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:23:31 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T15:23:32 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'ae4f7668-b56e-436c-ade9-378c06c40700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 20:23:32 GMT'
    'Content-Length': '1753'
2025-10-02T15:23:32 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T15:23:32 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b78c70c5-0957-4c36-ae53-2681f5541100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 20:23:32 GMT'
    'Content-Length': '7943'
2025-10-02T15:23:32 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T15:23:32 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T15:23:33 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T15:23:33 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T15:23:34 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T20:23:34","request-id":"561f6d6a-21e8-42bc-a8b6-cec17252b49b","client-request-id":"561f6d6a-21e8-42bc-a8b6-cec17252b49b
2025-10-02T15:23:34 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T15:23:34 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T15:23:34 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T20:23:34","request-id":"01f4084e-acb5-499a-816a-bb698be2e359","client-request-id":"01f4084e-acb5-499a-816a-bb698be2e359
2025-10-02T15:23:34 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T15:23:34 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T15:23:34 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T15:23:34 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T15:23:34 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T15:23:34 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T15:23:36 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T15:23:36 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T15:23:36 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T15:24:03 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T15:24:03 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T15:24:19 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:25:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:25:34 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T15:25:35 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T15:26:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:27:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:27:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 483 seconds, refreshing...
2025-10-02T15:27:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T15:28:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:29:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:30:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:31:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:31:41 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T15:31:41 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T15:32:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:33:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:34:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:35:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:36:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:37:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:37:41 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: d64ed65b-dc89-4c0f-be62-17d4dcbe30c5, function type: sync, timestamp (UTC): 2025-10-02 20:37:41.024078, sync threadpool max workers: 1000
2025-10-02T15:37:41 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T15:37:41 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-02T15:37:41 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T15:38:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:39:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:39:43 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T15:39:44 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 6300c700-5597-4ddd-8a84-85186ddaf819, function type: sync, timestamp (UTC): 2025-10-02 20:39:44.494720, sync threadpool max workers: 1000
2025-10-02T15:39:44 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T15:39:44 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T15:39:44 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T15:40:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:41:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:41:41 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: ad892bc6-4f83-4931-bf4a-f2fec4e8c74a, function type: sync, timestamp (UTC): 2025-10-02 20:41:41.681645, sync threadpool max workers: 1000
2025-10-02T15:41:41 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T15:41:47 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T15:42:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:43:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:44:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:45:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:46:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:47:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:48:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:49:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:50:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:51:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:52:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:53:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:54:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:55:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:56:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:57:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:58:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T15:59:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:00:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:01:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:02:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:02:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 671 seconds, refreshing...
2025-10-02T16:02:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T16:03:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:04:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:05:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:06:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:07:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:07:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 371 seconds, refreshing...
2025-10-02T16:07:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T16:08:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:09:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:10:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:11:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:12:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:13:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:14:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:15:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:16:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:17:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:18:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:19:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:20:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:21:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:22:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:23:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:24:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:25:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:25:34 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T16:25:34 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a6c2621c-5b22-4a50-9c22-318422281100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 21:25:34 GMT'
    'Content-Length': '1753'
2025-10-02T16:25:34 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T16:25:35 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'a6c2621c-5b22-4a50-9c22-318425281100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 21:25:34 GMT'
    'Content-Length': '7944'
2025-10-02T16:25:35 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T16:25:35 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T16:25:36 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T16:25:36 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T16:25:37 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T21:25:38","request-id":"830fafc4-791f-45dc-a343-31b743041493","client-request-id":"830fafc4-791f-45dc-a343-31b743041493
2025-10-02T16:25:37 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T16:25:37 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T16:25:37 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T21:25:38","request-id":"4a6e5b63-9b3b-4c56-88be-509799d899bd","client-request-id":"4a6e5b63-9b3b-4c56-88be-509799d899bd
2025-10-02T16:25:37 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T16:25:37 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T16:25:37 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T16:25:37 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T16:25:37 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T16:25:37 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T16:25:40 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T16:25:40 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T16:25:40 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T16:26:08 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T16:26:08 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T16:26:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:27:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:27:38 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 88169d52-4d23-42f6-8949-e8fa13a49bb3, function type: sync, timestamp (UTC): 2025-10-02 21:27:38.551456, sync threadpool max workers: 1000
2025-10-02T16:27:38 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T16:27:38 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T16:27:38 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T16:27:39 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T16:28:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:29:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:30:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:31:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:31:48 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 332398f7-b4f4-409b-8b0e-b0950331700f, function type: sync, timestamp (UTC): 2025-10-02 21:31:48.315594, sync threadpool max workers: 1000
2025-10-02T16:31:48 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T16:31:54 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T16:32:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 827 seconds, refreshing...
2025-10-02T16:32:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T16:32:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:33:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:34:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:35:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:36:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:37:20 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 527 seconds, refreshing...
2025-10-02T16:37:20 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T16:37:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:38:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:39:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:39:44 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T16:39:45 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: da38d7be-0e6f-4a39-8bf9-a7e060a93b2d, function type: sync, timestamp (UTC): 2025-10-02 21:39:45.609620, sync threadpool max workers: 1000
2025-10-02T16:39:45 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T16:39:46 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T16:39:46 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T16:40:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:41:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:41:55 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T16:41:55 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T16:42:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:43:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:44:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:45:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:46:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:47:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:48:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:49:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:50:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:51:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:52:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:53:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:54:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:55:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:56:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:57:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:58:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T16:59:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:00:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:01:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:02:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 794 seconds, refreshing...
2025-10-02T17:02:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T17:02:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:03:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:04:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:05:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:06:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:07:20 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 494 seconds, refreshing...
2025-10-02T17:07:20 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T17:07:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:08:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:09:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:10:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:11:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:12:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:13:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:14:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:15:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:16:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:17:22 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 9d9b16e2-266a-40a8-a6d1-9f182e298050, function type: sync, timestamp (UTC): 2025-10-02 22:17:22.344451, sync threadpool max workers: 1000
2025-10-02T17:17:22 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T17:17:22 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-02T17:17:22 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T17:17:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:18:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:19:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:20:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:21:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:21:56 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 764413b1-d6bc-41be-b1c5-498482f64076, function type: sync, timestamp (UTC): 2025-10-02 22:21:56.473145, sync threadpool max workers: 1000
2025-10-02T17:21:56 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T17:22:02 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T17:22:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:23:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:24:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:25:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:26:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:27:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:27:38 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T17:27:39 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '27da7b46-35b7-4d5f-b7f4-fda4d7b24a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 22:27:39 GMT'
    'Content-Length': '1753'
2025-10-02T17:27:39 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T17:27:39 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '69707f45-b6a6-46eb-aff1-83cbaeaf1400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 22:27:39 GMT'
    'Content-Length': '7943'
2025-10-02T17:27:39 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T17:27:39 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T17:27:40 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T17:27:40 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T17:27:40 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T22:27:41","request-id":"5335d931-af91-4806-9fed-bbc1ac0bd001","client-request-id":"5335d931-af91-4806-9fed-bbc1ac0bd001
2025-10-02T17:27:40 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T17:27:40 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T17:27:40 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T22:27:41","request-id":"332499d7-c677-42f0-adb8-bda7361a4e66","client-request-id":"332499d7-c677-42f0-adb8-bda7361a4e66
2025-10-02T17:27:40 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T17:27:40 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T17:27:40 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T17:27:40 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T17:27:40 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T17:27:40 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T17:27:42 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T17:27:42 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T17:27:42 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T17:28:01 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T17:28:01 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T17:28:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:28:57 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T17:28:59 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T17:29:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:30:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:31:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:32:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:33:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:34:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:35:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:36:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:37:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:38:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:39:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:39:46 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T17:39:46 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: bb2d4e15-600c-4382-9187-3b91d05174ac, function type: sync, timestamp (UTC): 2025-10-02 22:39:46.509943, sync threadpool max workers: 1000
2025-10-02T17:39:46 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T17:39:46 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T17:39:46 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T17:40:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:41:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:42:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:43:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:44:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:45:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:46:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:47:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:48:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:49:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:50:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:51:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:52:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 867 seconds, refreshing...
2025-10-02T17:52:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T17:52:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:53:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:54:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:55:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:56:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:57:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 567 seconds, refreshing...
2025-10-02T17:57:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T17:57:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:58:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T17:59:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:00:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:01:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:02:02 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T18:02:02 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T18:02:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:03:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:04:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:05:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:06:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:07:10 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: f135dc29-c96b-40e0-bafa-cbe1de6b48a8, function type: sync, timestamp (UTC): 2025-10-02 23:07:10.947119, sync threadpool max workers: 1000
2025-10-02T18:07:10 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T18:07:10 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T18:07:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 618 seconds, refreshing...
2025-10-02T18:07:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T18:07:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:08:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:09:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:10:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:11:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:12:03 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 348de226-df82-48df-993d-206eb15c8512, function type: sync, timestamp (UTC): 2025-10-02 23:12:03.507463, sync threadpool max workers: 1000
2025-10-02T18:12:03 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T18:12:09 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T18:12:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 318 seconds, refreshing...
2025-10-02T18:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T18:12:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:13:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:14:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:15:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:16:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:17:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:18:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:19:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:20:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:21:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:22:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:23:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:24:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:25:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:26:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:27:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:28:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:28:57 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T18:28:57 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '06f90c2a-42e6-4049-8d60-34f48cfd4200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 23:28:58 GMT'
    'Content-Length': '1753'
2025-10-02T18:28:57 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T18:28:57 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '3112b7b7-4a65-430f-b365-a85f2dbe0e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Thu, 02 Oct 2025 23:28:58 GMT'
    'Content-Length': '7943'
2025-10-02T18:28:57 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T18:28:57 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T18:28:59 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T18:28:59 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T18:29:00 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T23:29:00","request-id":"0ea4c5d4-d29b-4f0d-972d-9099dacded44","client-request-id":"0ea4c5d4-d29b-4f0d-972d-9099dacded44
2025-10-02T18:29:00 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T18:29:00 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T18:29:00 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-02T23:29:00","request-id":"e634f42c-f55d-4b71-85a1-2107ace24dab","client-request-id":"e634f42c-f55d-4b71-85a1-2107ace24dab
2025-10-02T18:29:00 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T18:29:00 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T18:29:00 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T18:29:00 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T18:29:00 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T18:29:00 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T18:29:02 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T18:29:02 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T18:29:02 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T18:29:19 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T18:29:19 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T18:29:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:30:18 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T18:30:19 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T18:30:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:31:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:32:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:33:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:34:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:35:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:36:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:37:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:38:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:39:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:39:46 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T18:39:47 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: f415b3e2-0a6e-4123-bae1-9c65aa83615c, function type: sync, timestamp (UTC): 2025-10-02 23:39:47.815981, sync threadpool max workers: 1000
2025-10-02T18:39:47 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T18:39:48 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T18:39:48 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T18:40:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:41:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:42:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:43:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:44:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:45:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:46:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:47:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:48:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:49:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:50:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:51:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:52:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:53:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:54:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:55:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:56:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:57:12 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: be36e8da-a366-4001-b85e-2567d83933ec, function type: sync, timestamp (UTC): 2025-10-02 23:57:12.617090, sync threadpool max workers: 1000
2025-10-02T18:57:12 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T18:57:12 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-02T18:57:12 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T18:57:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 677 seconds, refreshing...
2025-10-02T18:57:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T18:57:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:58:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T18:59:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:00:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:01:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:02:09 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: d66c466a-8ac1-4d2b-ae79-efc119a52150, function type: sync, timestamp (UTC): 2025-10-03 00:02:09.565245, sync threadpool max workers: 1000
2025-10-02T19:02:09 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T19:02:15 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T19:02:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 377 seconds, refreshing...
2025-10-02T19:02:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T19:02:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:03:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:04:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:05:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:06:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:07:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 696 seconds, refreshing...
2025-10-02T19:07:21 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T19:07:21 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T19:07:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T19:07:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:08:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:09:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:10:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:11:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:12:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 395 seconds, refreshing...
2025-10-02T19:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T19:12:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:13:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:14:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:15:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:16:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:17:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:18:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:19:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:20:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:21:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:22:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:23:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:24:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:25:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:26:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:27:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:28:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:29:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:30:18 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T19:30:18 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'a09e2aff-bf83-4b34-aa49-7fdaa6300e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 00:30:19 GMT'
    'Content-Length': '1753'
2025-10-02T19:30:18 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T19:30:18 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '75814d5f-7359-4374-b81d-e0fa4e121900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 00:30:19 GMT'
    'Content-Length': '7943'
2025-10-02T19:30:18 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T19:30:18 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T19:30:20 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T19:30:20 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T19:30:20 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T00:30:21","request-id":"5cd40de5-9435-4740-a9e5-9a364ab8c744","client-request-id":"5cd40de5-9435-4740-a9e5-9a364ab8c744
2025-10-02T19:30:20 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T19:30:20 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T19:30:20 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T00:30:21","request-id":"eced6dd7-caf0-4b4c-b887-260938edb0f6","client-request-id":"eced6dd7-caf0-4b4c-b887-260938edb0f6
2025-10-02T19:30:20 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T19:30:20 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T19:30:20 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T19:30:20 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T19:30:20 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T19:30:20 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T19:30:22 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T19:30:22 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T19:30:22 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T19:30:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:30:42 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T19:30:42 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T19:31:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:31:40 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T19:31:42 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T19:32:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:33:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:34:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:35:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:36:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:37:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:38:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:39:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:39:48 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T19:39:49 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: d1bc05b7-aab6-4de5-88e1-097517021f07, function type: sync, timestamp (UTC): 2025-10-03 00:39:49.292590, sync threadpool max workers: 1000
2025-10-02T19:39:49 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T19:39:49 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T19:39:49 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T19:40:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:41:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:42:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:43:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:44:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:45:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:46:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:47:21 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: b716ed97-81e1-435e-9810-125c6a37ea37, function type: sync, timestamp (UTC): 2025-10-03 00:47:21.418159, sync threadpool max workers: 1000
2025-10-02T19:47:21 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T19:47:21 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T19:47:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:48:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:49:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:50:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:51:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:52:15 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 827838a6-060e-4262-ba5b-4b0c75fa34e7, function type: sync, timestamp (UTC): 2025-10-03 00:52:15.858858, sync threadpool max workers: 1000
2025-10-02T19:52:15 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T19:52:21 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T19:52:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:53:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:54:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:55:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:56:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:57:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:58:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T19:59:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:00:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:01:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:02:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:03:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:04:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:05:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:06:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:07:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 776 seconds, refreshing...
2025-10-02T20:07:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T20:07:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 750 seconds, refreshing...
2025-10-02T20:07:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T20:07:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:08:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:09:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:10:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:11:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:12:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 476 seconds, refreshing...
2025-10-02T20:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T20:12:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 450 seconds, refreshing...
2025-10-02T20:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T20:12:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:13:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:14:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:15:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:16:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:17:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:18:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:19:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:20:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:21:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:22:21 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T20:22:21 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T20:22:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:23:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:24:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:25:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:26:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:27:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:28:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:29:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:30:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:31:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:31:40 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T20:31:40 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '774d0df2-4810-4624-8015-d7b279401900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 01:31:40 GMT'
    'Content-Length': '1753'
2025-10-02T20:31:40 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T20:31:40 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8399a6a7-6e06-4038-a8fd-023338574400'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 01:31:40 GMT'
    'Content-Length': '7943'
2025-10-02T20:31:40 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T20:31:40 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T20:31:42 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T20:31:42 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T20:31:42 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T01:31:43","request-id":"6f1e2103-803c-46eb-b1e6-a0dd00c9fcf2","client-request-id":"6f1e2103-803c-46eb-b1e6-a0dd00c9fcf2
2025-10-02T20:31:42 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T20:31:42 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T20:31:42 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T01:31:43","request-id":"07980902-d3e1-4df5-8abb-eb4c6b0c7570","client-request-id":"07980902-d3e1-4df5-8abb-eb4c6b0c7570
2025-10-02T20:31:42 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T20:31:42 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T20:31:42 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T20:31:42 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T20:31:42 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T20:31:42 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T20:31:45 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T20:31:45 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T20:31:45 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T20:32:03 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T20:32:03 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T20:32:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:33:04 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T20:33:05 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T20:33:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:34:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:35:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:36:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:37:25 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 73bdf09b-bbd5-44bb-9309-a3311a2fac3e, function type: sync, timestamp (UTC): 2025-10-03 01:37:25.251808, sync threadpool max workers: 1000
2025-10-02T20:37:25 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T20:37:25 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-02T20:37:25 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T20:37:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:38:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:39:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:39:49 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T20:39:50 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 464a8b50-dee8-48ed-8110-3b2167255125, function type: sync, timestamp (UTC): 2025-10-03 01:39:50.284414, sync threadpool max workers: 1000
2025-10-02T20:39:50 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T20:39:50 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T20:39:50 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T20:40:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:41:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:42:24 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 0af45877-c20c-4df4-a93b-786fc830113f, function type: sync, timestamp (UTC): 2025-10-03 01:42:24.176064, sync threadpool max workers: 1000
2025-10-02T20:42:24 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T20:42:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:42:30 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T20:43:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:44:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:45:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:46:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:47:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:48:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:49:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:50:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:51:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:52:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:53:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:54:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:55:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:56:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:57:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:58:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T20:59:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:00:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:01:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:02:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:03:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:04:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:05:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:06:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:07:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 858 seconds, refreshing...
2025-10-02T21:07:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T21:07:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:08:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:09:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:10:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:11:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:12:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 558 seconds, refreshing...
2025-10-02T21:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T21:12:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 841 seconds, refreshing...
2025-10-02T21:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T21:12:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:13:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:14:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:15:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:16:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:17:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 541 seconds, refreshing...
2025-10-02T21:17:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T21:17:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:18:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:19:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:20:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:21:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:22:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:22:30 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T21:22:30 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T21:23:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:24:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:25:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:26:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:27:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:27:35 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: d62043fa-b52e-4502-8a09-ade13855fd9b, function type: sync, timestamp (UTC): 2025-10-03 02:27:35.160965, sync threadpool max workers: 1000
2025-10-02T21:27:35 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T21:27:35 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T21:28:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:29:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:30:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:31:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:32:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:32:31 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 4c75efbd-8d5a-4890-88dc-acff3800f609, function type: sync, timestamp (UTC): 2025-10-03 02:32:31.487215, sync threadpool max workers: 1000
2025-10-02T21:32:31 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T21:32:37 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T21:33:04 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T21:33:04 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'df163bbf-5101-4e20-8714-6d7c1bf61a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 02:33:05 GMT'
    'Content-Length': '1753'
2025-10-02T21:33:04 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T21:33:05 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ea0ab156-a8bc-4e65-9c08-6865a9eb1a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 02:33:05 GMT'
    'Content-Length': '7943'
2025-10-02T21:33:05 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T21:33:05 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T21:33:06 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T21:33:06 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T21:33:06 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T02:33:07","request-id":"349f69be-c7f7-4ebf-b1df-0dd51fb5d2b9","client-request-id":"349f69be-c7f7-4ebf-b1df-0dd51fb5d2b9
2025-10-02T21:33:06 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T21:33:06 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T21:33:06 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T02:33:07","request-id":"47531ada-047f-451c-9ef9-06177a0be7a3","client-request-id":"47531ada-047f-451c-9ef9-06177a0be7a3
2025-10-02T21:33:06 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T21:33:06 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T21:33:06 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T21:33:06 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T21:33:06 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T21:33:06 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T21:33:09 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T21:33:09 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T21:33:09 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T21:33:28 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:33:35 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T21:33:35 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T21:34:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:35:03 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T21:35:04 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T21:35:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:36:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:37:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:38:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:39:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:39:50 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T21:39:51 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 1e271c22-ba9f-4e71-a597-de3bcfa82875, function type: sync, timestamp (UTC): 2025-10-03 02:39:51.364507, sync threadpool max workers: 1000
2025-10-02T21:39:51 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T21:39:51 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T21:39:51 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T21:40:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:41:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:42:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:43:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:44:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:45:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:46:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:47:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:48:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:49:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:50:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:51:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:52:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:53:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:54:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:55:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:56:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:57:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:58:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T21:59:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:00:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:01:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:02:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:03:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:04:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:05:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:06:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:07:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:08:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:09:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:10:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:11:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:12:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 643 seconds, refreshing...
2025-10-02T22:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T22:12:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 846 seconds, refreshing...
2025-10-02T22:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T22:12:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:13:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:14:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:15:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:16:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:17:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 343 seconds, refreshing...
2025-10-02T22:17:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T22:17:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 546 seconds, refreshing...
2025-10-02T22:17:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T22:17:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:17:38 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 5838e8ac-3907-4192-8bd3-40d122255f5e, function type: sync, timestamp (UTC): 2025-10-03 03:17:38.219291, sync threadpool max workers: 1000
2025-10-02T22:17:38 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T22:17:38 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-02T22:17:38 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T22:18:31 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:19:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:20:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:21:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:22:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:22:38 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T22:22:38 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T22:22:38 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 4fd0bc42-1f01-4cae-a2cb-07971a330b18, function type: sync, timestamp (UTC): 2025-10-03 03:22:38.732659, sync threadpool max workers: 1000
2025-10-02T22:22:38 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T22:22:44 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T22:23:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:24:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:25:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:26:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:27:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:28:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:29:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:30:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:31:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:32:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:33:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:34:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:35:03 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T22:35:03 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '587ec7ed-4b68-498c-a643-f695c11c1d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 03:35:04 GMT'
    'Content-Length': '1753'
2025-10-02T22:35:03 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T22:35:04 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '8ed38eec-9dbf-4f59-be49-6a2c5ad31d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 03:35:04 GMT'
    'Content-Length': '7943'
2025-10-02T22:35:04 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T22:35:04 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T22:35:05 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T22:35:05 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T22:35:06 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T03:35:06","request-id":"1cae66fd-9c5b-4516-9dbe-ac54b4773e59","client-request-id":"1cae66fd-9c5b-4516-9dbe-ac54b4773e59
2025-10-02T22:35:06 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T22:35:06 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T22:35:06 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T03:35:06","request-id":"5327954e-638d-4a16-ba17-b1076ab0cbfe","client-request-id":"5327954e-638d-4a16-ba17-b1076ab0cbfe
2025-10-02T22:35:06 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T22:35:06 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T22:35:06 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T22:35:06 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T22:35:06 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T22:35:06 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T22:35:08 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T22:35:08 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T22:35:08 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T22:35:32 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:35:35 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T22:35:35 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T22:36:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:37:05 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T22:37:06 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T22:37:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:38:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:39:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:39:52 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T22:39:52 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: c48b6b13-8a9b-4d11-96a9-770fa6f1fb08, function type: sync, timestamp (UTC): 2025-10-03 03:39:52.524566, sync threadpool max workers: 1000
2025-10-02T22:39:52 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T22:39:52 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T22:39:52 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T22:40:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:41:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:42:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:43:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:44:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:45:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:46:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:47:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:48:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:49:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:50:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:51:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:52:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:53:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:54:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:55:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:56:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:57:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:58:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T22:59:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:00:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:01:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:02:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:03:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:04:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:05:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:06:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:07:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:07:47 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: bc192798-ff9b-414d-b09e-b02f80fba457, function type: sync, timestamp (UTC): 2025-10-03 04:07:47.028738, sync threadpool max workers: 1000
2025-10-02T23:07:47 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T23:07:47 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T23:08:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:09:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:10:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:11:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:12:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 762 seconds, refreshing...
2025-10-02T23:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T23:12:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:12:45 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 376c6324-7bbe-4380-be21-6ae19e1e38fd, function type: sync, timestamp (UTC): 2025-10-03 04:12:45.159151, sync threadpool max workers: 1000
2025-10-02T23:12:45 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T23:12:50 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-02T23:13:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:14:34 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:15:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:16:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:17:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 462 seconds, refreshing...
2025-10-02T23:17:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-02T23:17:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:18:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:19:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:20:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:21:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:22:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 653 seconds, refreshing...
2025-10-02T23:22:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T23:22:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:23:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:24:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:25:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:26:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:27:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 353 seconds, refreshing...
2025-10-02T23:27:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T23:27:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:28:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:29:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:30:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:31:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:32:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:32:51 | INFO | root | Successfully acquired user token via ROPC
2025-10-02T23:32:51 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-02T23:33:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:34:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:35:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:36:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:37:05 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-02T23:37:06 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '5c5723e0-1640-4ba5-a8f0-8eb9e22f1900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 04:37:06 GMT'
    'Content-Length': '1753'
2025-10-02T23:37:06 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-02T23:37:06 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'c63e7894-30b0-442d-bc92-8d8194de1e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 04:37:06 GMT'
    'Content-Length': '7943'
2025-10-02T23:37:06 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-02T23:37:06 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-02T23:37:07 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-02T23:37:07 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T23:37:08 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T04:37:09","request-id":"c15ad5d8-5327-40c2-89fd-50ef10a7d54d","client-request-id":"c15ad5d8-5327-40c2-89fd-50ef10a7d54d
2025-10-02T23:37:08 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-02T23:37:08 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T23:37:08 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T04:37:09","request-id":"297440c0-c860-4713-987d-7a65cf2fb604","client-request-id":"297440c0-c860-4713-987d-7a65cf2fb604
2025-10-02T23:37:08 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-02T23:37:08 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-02T23:37:08 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-02T23:37:08 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-02T23:37:08 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-02T23:37:08 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-02T23:37:11 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-02T23:37:11 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-02T23:37:11 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-02T23:37:35 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:37:37 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-02T23:37:37 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-02T23:38:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:39:03 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-02T23:39:04 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-02T23:39:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:39:52 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-02T23:39:53 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: cdc1055c-7056-4548-af27-bd55d29c9060, function type: sync, timestamp (UTC): 2025-10-03 04:39:53.697768, sync threadpool max workers: 1000
2025-10-02T23:39:53 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-02T23:39:54 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-02T23:39:54 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-02T23:40:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:41:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:42:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:43:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:44:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:45:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:46:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:47:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:48:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:49:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:50:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:51:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:52:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:53:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:54:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:55:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:56:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:57:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:57:58 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: bac4b01f-28ff-4e22-b5dd-5986acb57e0b, function type: sync, timestamp (UTC): 2025-10-03 04:57:58.692809, sync threadpool max workers: 1000
2025-10-02T23:57:58 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T23:57:58 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-02T23:57:58 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-02T23:58:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-02T23:59:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:00:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:01:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:02:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:02:52 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 84119dc4-7f5f-497e-a495-11366d123028, function type: sync, timestamp (UTC): 2025-10-03 05:02:52.448912, sync threadpool max workers: 1000
2025-10-03T00:02:52 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T00:02:57 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T00:03:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:04:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:05:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:06:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:07:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:08:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:09:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:10:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:11:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:12:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 884 seconds, refreshing...
2025-10-03T00:12:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T00:12:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:13:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:14:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:15:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:16:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:17:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 584 seconds, refreshing...
2025-10-03T00:17:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T00:17:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:18:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:19:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:20:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:21:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:22:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:23:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:24:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:25:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:26:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:27:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:28:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:29:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:30:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:31:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:32:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 602 seconds, refreshing...
2025-10-03T00:32:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T00:32:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:33:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:34:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:35:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:36:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:37:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 302 seconds, refreshing...
2025-10-03T00:37:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T00:37:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:38:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:39:03 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T00:39:03 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'aafeba37-4047-4a9b-979f-a350fc141c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 05:39:04 GMT'
    'Content-Length': '1753'
2025-10-03T00:39:03 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T00:39:04 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ae9fe20a-5ec8-4421-ba47-4ebf7a683500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 05:39:04 GMT'
    'Content-Length': '7944'
2025-10-03T00:39:04 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T00:39:04 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T00:39:05 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T00:39:05 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T00:39:06 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T05:39:06","request-id":"6eba8d49-e684-4f9a-8b4b-872e0e030d2c","client-request-id":"6eba8d49-e684-4f9a-8b4b-872e0e030d2c
2025-10-03T00:39:06 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T00:39:06 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T00:39:06 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T05:39:06","request-id":"8d29ded8-7e4a-414a-9e74-ab806dcd0127","client-request-id":"8d29ded8-7e4a-414a-9e74-ab806dcd0127
2025-10-03T00:39:06 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T00:39:06 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T00:39:06 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T00:39:06 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T00:39:06 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T00:39:06 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T00:39:07 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T00:39:07 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T00:39:11 | INFO | planner_sync_service_v5 |    Found 21 plans across 5 groups
2025-10-03T00:39:11 | INFO | planner_sync_service_v5 | ?? Total plans found: 22
2025-10-03T00:39:11 | INFO | planner_sync_service_v5 | 📋 Polling 22 Planner plans for task changes
2025-10-03T00:39:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:39:38 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T00:39:38 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T00:39:54 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T00:39:57 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 5f1455dc-8a9f-48d7-8373-8c04778f5b2e, function type: sync, timestamp (UTC): 2025-10-03 05:39:57.982954, sync threadpool max workers: 1000
2025-10-03T00:39:57 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T00:39:58 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T00:39:58 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T00:40:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:41:08 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T00:41:09 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T00:41:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:42:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:43:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:44:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:45:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:46:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:47:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:48:10 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 37d83674-2e21-4d11-96d0-ee275f91e834, function type: sync, timestamp (UTC): 2025-10-03 05:48:10.400458, sync threadpool max workers: 1000
2025-10-03T00:48:10 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T00:48:10 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T00:48:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:49:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:50:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:51:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:52:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:52:58 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: d300680e-0ea1-4847-8cbf-e0dde29e8e9f, function type: sync, timestamp (UTC): 2025-10-03 05:52:58.582502, sync threadpool max workers: 1000
2025-10-03T00:52:58 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T00:53:04 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T00:53:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:54:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:55:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:56:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:57:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:58:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T00:59:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:00:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:01:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:02:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:03:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:04:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:05:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:06:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:07:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:08:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:09:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:10:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:11:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:12:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:13:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:14:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:15:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:16:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:17:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 702 seconds, refreshing...
2025-10-03T01:17:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T01:17:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:18:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:19:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:20:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:21:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:22:21 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 402 seconds, refreshing...
2025-10-03T01:22:21 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T01:22:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:23:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:24:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:25:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:26:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:27:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:28:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:29:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:30:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:31:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:32:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:33:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:34:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:35:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:36:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:37:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:38:28 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: c9a832ec-6936-44dd-a977-e9241ccfd78a, function type: sync, timestamp (UTC): 2025-10-03 06:38:28.048537, sync threadpool max workers: 1000
2025-10-03T01:38:28 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T01:38:28 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T01:38:28 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T01:38:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:39:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:39:59 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T01:40:01 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 18f07eb2-2038-4bc4-8001-195208af1a52, function type: sync, timestamp (UTC): 2025-10-03 06:40:01.244920, sync threadpool max workers: 1000
2025-10-03T01:40:01 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T01:40:01 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T01:40:01 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T01:40:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:41:08 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T01:41:09 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'bcc93523-a8b2-4e02-b391-1d91e3a75200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 06:41:09 GMT'
    'Content-Length': '1753'
2025-10-03T01:41:09 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T01:41:09 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ea0ab156-a8bc-4e65-9c08-6865a1f91f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 06:41:09 GMT'
    'Content-Length': '7943'
2025-10-03T01:41:09 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T01:41:09 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T01:41:10 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T01:41:10 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T01:41:11 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T06:41:12","request-id":"59e3d3fa-db06-40d2-9132-e28218bf8f51","client-request-id":"59e3d3fa-db06-40d2-9132-e28218bf8f51
2025-10-03T01:41:11 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T01:41:11 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T01:41:11 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T06:41:12","request-id":"6ab1313e-2de5-456e-ae4a-7e1bbf8fc735","client-request-id":"6ab1313e-2de5-456e-ae4a-7e1bbf8fc735
2025-10-03T01:41:11 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T01:41:11 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T01:41:11 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T01:41:11 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T01:41:11 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T01:41:11 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T01:41:14 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T01:41:14 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T01:41:14 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T01:41:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:41:41 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T01:41:41 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T01:42:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:43:09 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T01:43:10 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: fd5a29f3-25c5-424f-b526-4e9281b34b28, function type: sync, timestamp (UTC): 2025-10-03 06:43:10.521091, sync threadpool max workers: 1000
2025-10-03T01:43:10 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T01:43:10 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T01:43:16 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T01:43:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:44:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:45:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:46:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:47:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 675 seconds, refreshing...
2025-10-03T01:47:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T01:47:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:48:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:49:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:50:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:51:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:52:21 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 375 seconds, refreshing...
2025-10-03T01:52:21 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T01:52:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:53:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:54:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:55:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:56:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:57:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:58:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T01:59:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:00:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:01:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:02:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:03:17 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T02:03:17 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T02:03:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:04:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:05:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:06:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:07:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:08:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:09:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:10:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:11:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:12:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:13:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:14:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:15:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:16:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:17:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 827 seconds, refreshing...
2025-10-03T02:17:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T02:17:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:18:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:19:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:20:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:21:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:22:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 527 seconds, refreshing...
2025-10-03T02:22:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T02:22:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:23:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:24:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:25:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:26:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:27:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:28:20 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 118ef952-850b-47a2-8f0c-19b01a3946e8, function type: sync, timestamp (UTC): 2025-10-03 07:28:20.394301, sync threadpool max workers: 1000
2025-10-03T02:28:20 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T02:28:20 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T02:28:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:29:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:30:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:31:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:32:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:33:18 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 13cb58b0-4b52-451c-bbe2-124ed0a4d152, function type: sync, timestamp (UTC): 2025-10-03 07:33:18.601949, sync threadpool max workers: 1000
2025-10-03T02:33:18 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T02:33:24 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T02:33:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:34:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:35:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:36:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:37:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:38:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:39:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:40:01 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T02:40:03 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 2b347bbc-03fc-41d1-96dd-e4f759de4923, function type: sync, timestamp (UTC): 2025-10-03 07:40:03.110540, sync threadpool max workers: 1000
2025-10-03T02:40:03 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T02:40:03 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T02:40:03 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T02:40:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:41:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:42:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:43:09 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T02:43:10 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c0f19528-0086-4025-83d4-ba140de52000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 07:43:10 GMT'
    'Content-Length': '1753'
2025-10-03T02:43:10 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T02:43:10 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '145e1241-e9ac-4046-93cc-799c464e2000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 07:43:10 GMT'
    'Content-Length': '7944'
2025-10-03T02:43:10 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T02:43:10 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T02:43:11 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T02:43:11 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T02:43:12 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T07:43:12","request-id":"67d650c3-bb56-4f82-a81c-e1c33a509bbc","client-request-id":"67d650c3-bb56-4f82-a81c-e1c33a509bbc
2025-10-03T02:43:12 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T02:43:12 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T02:43:12 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T07:43:12","request-id":"38c23c92-c0d3-4769-9bcd-f14475b47705","client-request-id":"38c23c92-c0d3-4769-9bcd-f14475b47705
2025-10-03T02:43:12 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T02:43:12 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T02:43:12 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T02:43:12 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T02:43:12 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T02:43:12 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T02:43:14 | INFO | planner_sync_service_v5 |    Found 10 plans across 5 groups
2025-10-03T02:43:14 | INFO | planner_sync_service_v5 | ?? Total plans found: 11
2025-10-03T02:43:14 | INFO | planner_sync_service_v5 | 📋 Polling 11 Planner plans for task changes
2025-10-03T02:43:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:43:41 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T02:43:41 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T02:44:41 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:45:10 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T02:45:10 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 229 tasks checked, 0 created, 0 updated
2025-10-03T02:45:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:46:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:47:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:48:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:49:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:50:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:51:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:52:22 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 704 seconds, refreshing...
2025-10-03T02:52:22 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T02:52:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:53:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:54:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:55:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:56:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:57:22 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 404 seconds, refreshing...
2025-10-03T02:57:22 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T02:57:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:58:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T02:59:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:00:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:01:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:02:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:03:26 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T03:03:26 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T03:03:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:04:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:05:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:06:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:07:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:08:42 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:09:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:10:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:11:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:12:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:13:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:14:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:15:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:16:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:17:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:18:26 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: f33dcaa1-52c2-424c-816c-896c63b4e596, function type: sync, timestamp (UTC): 2025-10-03 08:18:26.231954, sync threadpool max workers: 1000
2025-10-03T03:18:26 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T03:18:26 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T03:18:26 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T03:18:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:19:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:20:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:21:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:22:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 648 seconds, refreshing...
2025-10-03T03:22:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T03:22:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:23:27 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: e64426d4-e065-404d-b6fb-36803120c427, function type: sync, timestamp (UTC): 2025-10-03 08:23:27.225322, sync threadpool max workers: 1000
2025-10-03T03:23:27 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T03:23:32 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T03:23:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:24:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:25:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:26:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:27:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 348 seconds, refreshing...
2025-10-03T03:27:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T03:27:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:28:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:29:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:30:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:31:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:32:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:33:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:34:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:35:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:36:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:37:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:38:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:39:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:40:03 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T03:40:04 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 72e64b71-bd7c-4b60-8b35-f8835748d717, function type: sync, timestamp (UTC): 2025-10-03 08:40:04.139600, sync threadpool max workers: 1000
2025-10-03T03:40:04 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T03:40:04 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T03:40:04 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T03:40:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:41:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:42:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:43:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:44:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:45:10 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T03:45:10 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'b8af34ab-e619-47c9-a1e1-9fa2c3042200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 08:45:10 GMT'
    'Content-Length': '1753'
2025-10-03T03:45:10 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T03:45:10 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b8af34ab-e619-47c9-a1e1-9fa2c4042200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 08:45:10 GMT'
    'Content-Length': '7944'
2025-10-03T03:45:10 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T03:45:10 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T03:45:12 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T03:45:12 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T03:45:12 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T08:45:13","request-id":"19f3cb26-d3a5-4181-886e-918a6263f067","client-request-id":"19f3cb26-d3a5-4181-886e-918a6263f067
2025-10-03T03:45:12 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T03:45:12 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T03:45:12 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T08:45:13","request-id":"b8ec557f-18fc-476d-9f45-3cc1f6a83406","client-request-id":"b8ec557f-18fc-476d-9f45-3cc1f6a83406
2025-10-03T03:45:12 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T03:45:12 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T03:45:12 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T03:45:12 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T03:45:12 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T03:45:12 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T03:45:15 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T03:45:15 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T03:45:15 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T03:45:43 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:45:43 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T03:45:43 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T03:46:44 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:47:12 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T03:47:12 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Link Google Ad Words to Goals
2025-10-03T03:47:12 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Link Google Ad Words to Goals
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Customer Feedback Collection
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Customer Feedback Collection
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Schedule a Consultation part
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Schedule a Consultation part
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Blog Content Strategy
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Blog Content Strategy
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Process Page
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Process Page
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Packages Page
2025-10-03T03:47:13 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Packages Page
2025-10-03T03:47:14 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Company Growth Strategies for Value and Profit Increase for KVB
2025-10-03T03:47:14 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Company Growth Strategies for Value and Profit Increase for KVB
2025-10-03T03:47:14 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Create an equivalent of a Lifestyle Analysis form to find out what kind of home a client "is".  The questionnaire will connect to an AI image generator that generates a custom home based on their answers to the form.
2025-10-03T03:47:14 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Create an equivalent of a Lifestyle Analysis form to find out what kind of home a client "is".  The questionnaire will connect to an AI image generator that generates a custom home based on their answers to the form.
2025-10-03T03:47:14 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Koviak Built Page Trilogy
2025-10-03T03:47:14 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Koviak Built Page Trilogy
2025-10-03T03:47:14 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: Complete the KVP Architect's Magazine
2025-10-03T03:47:14 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: Complete the KVP Architect's Magazine
2025-10-03T03:47:15 | INFO | planner_sync_service_v5 | ✅ Created Annika task from Planner: check for brush at hunters cabin
2025-10-03T03:47:15 | INFO | planner_sync_service_v5 | 📝 Created new task from Planner: check for brush at hunters cabin
2025-10-03T03:47:16 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 11 created, 0 updated
2025-10-03T03:47:16 | INFO | planner_sync_service_v5 | 📤 Processing upload batch of 10 tasks
2025-10-03T03:47:23 | INFO | planner_sync_service_v5 | 📤 Processing upload batch of 1 tasks
2025-10-03T03:47:29 | INFO | planner_sync_service_v5 | ⏱️ Quick poll triggered after local update (delay=10s)
2025-10-03T03:47:29 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T03:47:32 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T03:47:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:48:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:49:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:50:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:51:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:52:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:53:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:54:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:55:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:56:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:57:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:58:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T03:59:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:00:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:01:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:02:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:03:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:04:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:05:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:06:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:07:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:08:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:09:09 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 5b546e68-d0a1-4edb-8fd7-27d0b008e28e, function type: sync, timestamp (UTC): 2025-10-03 09:09:09.592425, sync threadpool max workers: 1000
2025-10-03T04:09:09 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T04:09:09 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T04:09:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:10:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:11:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:12:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:13:33 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: d656065d-1d85-4e63-99cf-166bd66c7230, function type: sync, timestamp (UTC): 2025-10-03 09:13:33.717513, sync threadpool max workers: 1000
2025-10-03T04:13:33 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T04:13:39 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T04:13:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:14:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:15:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:16:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:17:22 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 726 seconds, refreshing...
2025-10-03T04:17:22 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T04:17:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:18:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:19:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:20:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:21:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:22:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 768 seconds, refreshing...
2025-10-03T04:22:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T04:22:22 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 426 seconds, refreshing...
2025-10-03T04:22:22 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T04:22:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:23:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:24:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:25:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:26:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:27:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 468 seconds, refreshing...
2025-10-03T04:27:22 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T04:27:22 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T04:27:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T04:27:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:28:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:29:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:30:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:31:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:32:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:33:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:34:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:35:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:36:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:37:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:38:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:39:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:40:04 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T04:40:05 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: e73372a6-1ce5-4f9e-9d00-58caf4aa71f8, function type: sync, timestamp (UTC): 2025-10-03 09:40:05.226600, sync threadpool max workers: 1000
2025-10-03T04:40:05 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T04:40:05 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T04:40:05 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T04:40:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:41:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:42:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:43:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:44:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:45:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:46:45 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:47:12 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T04:47:13 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'bfbcb4f5-f375-4964-9568-16446edc2300'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 09:47:13 GMT'
    'Content-Length': '1753'
2025-10-03T04:47:13 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T04:47:13 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'ca1f43b3-b6eb-46cc-8dea-aa69cd8b1500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 09:47:13 GMT'
    'Content-Length': '7941'
2025-10-03T04:47:13 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T04:47:13 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T04:47:16 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T04:47:16 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T04:47:17 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T09:47:17","request-id":"4889e8c6-47ed-45c4-9a8f-8eafc4a95430","client-request-id":"4889e8c6-47ed-45c4-9a8f-8eafc4a95430
2025-10-03T04:47:17 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T04:47:17 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T04:47:17 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T09:47:17","request-id":"8dbbb986-b1d3-41aa-828e-2636345a99ad","client-request-id":"8dbbb986-b1d3-41aa-828e-2636345a99ad
2025-10-03T04:47:17 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T04:47:17 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T04:47:17 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T04:47:17 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T04:47:17 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T04:47:17 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T04:47:19 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T04:47:19 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T04:47:19 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T04:47:46 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:47:54 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T04:47:54 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T04:48:47 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:49:22 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T04:49:23 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T04:49:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:50:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:51:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:52:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:53:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:54:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:55:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:56:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:57:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:58:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T04:58:59 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 4eb5e834-a7a1-457b-af43-7c3c70da57a6, function type: sync, timestamp (UTC): 2025-10-03 09:58:59.508343, sync threadpool max workers: 1000
2025-10-03T04:58:59 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T04:58:59 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T04:58:59 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T04:59:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:00:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:01:48 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:02:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:03:40 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 064ff982-fe1a-4201-9568-27a23c5fce97, function type: sync, timestamp (UTC): 2025-10-03 10:03:40.027455, sync threadpool max workers: 1000
2025-10-03T05:03:40 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T05:03:45 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T05:03:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:04:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:05:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:06:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:07:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:08:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:09:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:10:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:11:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:12:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:13:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:14:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:15:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:16:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:17:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:18:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:19:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:20:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:21:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:22:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 890 seconds, refreshing...
2025-10-03T05:22:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T05:22:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:23:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:24:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:25:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:26:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:27:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 590 seconds, refreshing...
2025-10-03T05:27:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T05:27:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:28:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:29:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:30:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:31:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:32:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:33:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:34:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:35:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:36:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:37:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:38:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:39:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:40:05 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T05:40:06 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 3d369969-7aa9-4b70-bc39-fee8fd541e6f, function type: sync, timestamp (UTC): 2025-10-03 10:40:06.293404, sync threadpool max workers: 1000
2025-10-03T05:40:06 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T05:40:06 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T05:40:06 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T05:40:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:41:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:42:22 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 605 seconds, refreshing...
2025-10-03T05:42:22 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T05:42:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:43:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:44:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:45:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:46:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:47:22 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 305 seconds, refreshing...
2025-10-03T05:47:22 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T05:47:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:48:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:48:59 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 4847ede3-d278-4408-9118-89487e810016, function type: sync, timestamp (UTC): 2025-10-03 10:48:59.170136, sync threadpool max workers: 1000
2025-10-03T05:48:59 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T05:48:59 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T05:49:22 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T05:49:23 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '6e68b2f7-c2e2-4090-adea-1ed2f7860c00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 10:49:23 GMT'
    'Content-Length': '1753'
2025-10-03T05:49:23 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T05:49:23 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'f77db40a-2bff-4f1b-84c8-7e5696815200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 10:49:23 GMT'
    'Content-Length': '7944'
2025-10-03T05:49:23 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T05:49:23 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T05:49:25 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T05:49:25 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T05:49:25 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T10:49:26","request-id":"43ae1d0c-1377-49df-93b9-b63ad2f84112","client-request-id":"43ae1d0c-1377-49df-93b9-b63ad2f84112
2025-10-03T05:49:25 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T05:49:25 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T05:49:25 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T10:49:26","request-id":"91edbc2c-1fbb-466e-a6f2-e5015a2daaa0","client-request-id":"91edbc2c-1fbb-466e-a6f2-e5015a2daaa0
2025-10-03T05:49:25 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T05:49:25 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T05:49:25 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T05:49:26 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T05:49:26 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T05:49:26 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T05:49:26 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T05:49:26 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T05:49:29 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T05:49:29 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T05:49:29 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T05:49:49 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:49:56 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T05:49:56 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T05:50:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:51:27 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T05:51:28 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T05:51:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:52:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:53:46 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 00bf531a-5540-4a1f-a291-d612a55c31a5, function type: sync, timestamp (UTC): 2025-10-03 10:53:46.594742, sync threadpool max workers: 1000
2025-10-03T05:53:46 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T05:53:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:53:52 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T05:54:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:55:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:56:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:57:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:58:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T05:59:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:00:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:01:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:02:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:03:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:04:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:05:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:06:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:07:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:08:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:09:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:10:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:11:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:12:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:13:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:14:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:15:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:16:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:17:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:18:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:19:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:20:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:21:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:22:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:23:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:24:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:25:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:26:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:27:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 720 seconds, refreshing...
2025-10-03T06:27:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T06:27:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:28:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:29:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:30:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:31:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:32:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 420 seconds, refreshing...
2025-10-03T06:32:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T06:32:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:33:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:34:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:35:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:36:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:37:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:38:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:38:58 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: be0cf396-cb0f-4daa-87e0-cf268674a647, function type: sync, timestamp (UTC): 2025-10-03 11:38:58.953822, sync threadpool max workers: 1000
2025-10-03T06:38:58 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T06:38:58 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T06:38:58 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T06:39:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:40:06 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T06:40:07 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 3d69826e-e9c1-4809-a84f-537b7ed83aa9, function type: sync, timestamp (UTC): 2025-10-03 11:40:07.361433, sync threadpool max workers: 1000
2025-10-03T06:40:07 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T06:40:07 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T06:40:07 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T06:40:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:41:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:42:22 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 658 seconds, refreshing...
2025-10-03T06:42:22 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T06:42:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:43:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:43:53 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 7b0f581c-300e-4742-a4bd-efdde5e0dbbd, function type: sync, timestamp (UTC): 2025-10-03 11:43:53.112184, sync threadpool max workers: 1000
2025-10-03T06:43:53 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T06:43:58 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T06:44:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:45:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:46:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:47:22 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 358 seconds, refreshing...
2025-10-03T06:47:22 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T06:47:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:48:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:49:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:50:52 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:51:27 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T06:51:28 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '58ed2a1a-3fe7-4b5e-a4de-e57654f02200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 11:51:29 GMT'
    'Content-Length': '1753'
2025-10-03T06:51:28 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T06:51:28 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '83a88813-9753-41b8-8e5a-69170b3f5f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 11:51:29 GMT'
    'Content-Length': '7943'
2025-10-03T06:51:28 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T06:51:28 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T06:51:30 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T06:51:30 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T06:51:30 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T11:51:31","request-id":"0605eb4c-1a2e-4f26-ac7f-eac57d0eef3e","client-request-id":"0605eb4c-1a2e-4f26-ac7f-eac57d0eef3e
2025-10-03T06:51:30 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T06:51:30 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T06:51:30 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T11:51:31","request-id":"03b51150-1737-44fc-926b-caddbf3874ff","client-request-id":"03b51150-1737-44fc-926b-caddbf3874ff
2025-10-03T06:51:30 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T06:51:30 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T06:51:30 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T06:51:31 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T06:51:31 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T06:51:31 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T06:51:31 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T06:51:31 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T06:51:34 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T06:51:34 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T06:51:34 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T06:51:53 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:52:01 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T06:52:01 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T06:52:55 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:53:29 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T06:53:30 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T06:53:55 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:54:55 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:55:55 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:56:55 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:57:55 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:58:55 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T06:59:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:00:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:01:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:02:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:03:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:04:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:05:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:06:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:07:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:08:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:09:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:10:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:11:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:12:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:13:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:14:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:15:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:16:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:17:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:18:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:19:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:20:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:21:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:22:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:23:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:24:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:25:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:26:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:27:22 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 845 seconds, refreshing...
2025-10-03T07:27:22 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T07:27:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:28:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:29:18 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 1311b72a-50f8-438d-8eb9-50c374defa04, function type: sync, timestamp (UTC): 2025-10-03 12:29:18.358187, sync threadpool max workers: 1000
2025-10-03T07:29:18 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T07:29:18 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T07:29:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:30:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:31:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:32:23 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 545 seconds, refreshing...
2025-10-03T07:32:23 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T07:32:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:33:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:34:00 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 201f6c17-a37d-4cfb-86f1-719df81d9633, function type: sync, timestamp (UTC): 2025-10-03 12:34:00.039613, sync threadpool max workers: 1000
2025-10-03T07:34:00 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T07:34:06 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T07:34:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:35:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:36:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:37:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:38:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:39:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:40:07 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T07:40:09 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 32bb2868-1b2a-4816-b253-9700f9655e3b, function type: sync, timestamp (UTC): 2025-10-03 12:40:09.111035, sync threadpool max workers: 1000
2025-10-03T07:40:09 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T07:40:09 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T07:40:09 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T07:40:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:41:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:42:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:43:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:44:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:45:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:46:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:47:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:48:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:49:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:50:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:51:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:52:56 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:53:29 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T07:53:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2736da0d-0bd0-4834-8711-aba106b12800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 12:53:30 GMT'
    'Content-Length': '1753'
2025-10-03T07:53:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T07:53:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '0f94c50f-847c-4614-95a0-1d996e6a2700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 12:53:30 GMT'
    'Content-Length': '7943'
2025-10-03T07:53:30 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T07:53:30 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T07:53:31 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T07:53:31 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T07:53:32 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T12:53:32","request-id":"47f5591d-66e7-42e0-b1b4-6ab24e5d9cbb","client-request-id":"47f5591d-66e7-42e0-b1b4-6ab24e5d9cbb
2025-10-03T07:53:32 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T07:53:32 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T07:53:32 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T12:53:32","request-id":"9b0c941a-68f9-415a-ba18-55037a956d23","client-request-id":"9b0c941a-68f9-415a-ba18-55037a956d23
2025-10-03T07:53:32 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T07:53:32 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T07:53:32 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T07:53:32 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T07:53:32 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T07:53:32 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T07:53:34 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T07:53:34 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T07:53:34 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T07:53:57 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:54:02 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T07:54:02 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T07:54:58 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:55:27 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T07:55:28 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T07:55:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:56:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:57:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:58:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T07:59:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:00:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:01:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:02:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:03:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:04:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:05:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:06:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:07:23 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 604 seconds, refreshing...
2025-10-03T08:07:23 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T08:07:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:08:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:09:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:10:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:11:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:12:23 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 304 seconds, refreshing...
2025-10-03T08:12:23 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T08:12:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:13:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:14:07 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T08:14:07 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T08:14:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:15:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:16:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:17:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:18:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:19:16 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 8bacef2d-67cd-4569-ae57-68a083649e8a, function type: sync, timestamp (UTC): 2025-10-03 13:19:16.731657, sync threadpool max workers: 1000
2025-10-03T08:19:16 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T08:19:16 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T08:19:16 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T08:19:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:20:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:21:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:22:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:23:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:24:08 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a4cb7bb1-a43a-4aec-873b-bd0f11db577c, function type: sync, timestamp (UTC): 2025-10-03 13:24:08.489520, sync threadpool max workers: 1000
2025-10-03T08:24:08 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T08:24:14 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T08:24:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:25:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:26:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:27:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:28:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:29:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:30:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:31:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:32:23 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 667 seconds, refreshing...
2025-10-03T08:32:23 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T08:32:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:33:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:34:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:35:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:36:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:37:23 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 367 seconds, refreshing...
2025-10-03T08:37:23 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T08:37:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:38:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:39:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:40:09 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T08:40:10 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a367dcfb-7666-44a2-915b-ba7ca777e94f, function type: sync, timestamp (UTC): 2025-10-03 13:40:10.985696, sync threadpool max workers: 1000
2025-10-03T08:40:10 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T08:40:11 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T08:40:11 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T08:40:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:41:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:42:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:43:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:44:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:45:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:46:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:47:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:48:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:49:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:50:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:51:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:52:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:53:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:54:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:55:27 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T08:55:28 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '63881724-9555-449d-a784-23f069510700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 13:55:28 GMT'
    'Content-Length': '1753'
2025-10-03T08:55:28 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T08:55:28 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '292a34f6-5298-4976-9178-5c385bc72700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 13:55:28 GMT'
    'Content-Length': '7943'
2025-10-03T08:55:28 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T08:55:28 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T08:55:29 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T08:55:29 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T08:55:29 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T13:55:30","request-id":"44728d2c-a344-44e3-87e9-5862d5cfcf5c","client-request-id":"44728d2c-a344-44e3-87e9-5862d5cfcf5c
2025-10-03T08:55:29 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T08:55:29 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T08:55:29 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T13:55:30","request-id":"4b91ef04-c183-43ad-8bb6-0fd9e6ca62aa","client-request-id":"4b91ef04-c183-43ad-8bb6-0fd9e6ca62aa
2025-10-03T08:55:29 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T08:55:29 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T08:55:29 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T08:55:29 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T08:55:30 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T08:55:30 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T08:55:32 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T08:55:32 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T08:55:32 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T08:55:59 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:56:01 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T08:56:01 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T08:57:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:57:30 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T08:57:31 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T08:58:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T08:59:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:00:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:01:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:02:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:02:23 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 865 seconds, refreshing...
2025-10-03T09:02:23 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T09:03:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:04:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:05:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:06:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:07:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:07:23 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 565 seconds, refreshing...
2025-10-03T09:07:23 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T09:08:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:09:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:10:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:10:03 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: aee2d622-b93f-4536-b83b-3bab54a8678e, function type: sync, timestamp (UTC): 2025-10-03 14:10:03.562597, sync threadpool max workers: 1000
2025-10-03T09:10:03 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T09:10:03 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T09:11:00 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:12:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:13:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:14:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:14:15 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T09:14:15 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T09:14:15 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 0faae756-ccbc-4ce1-a3ac-db9e08199bfd, function type: sync, timestamp (UTC): 2025-10-03 14:14:15.742144, sync threadpool max workers: 1000
2025-10-03T09:14:15 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T09:14:21 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T09:15:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:16:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:17:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:18:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:19:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:20:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:21:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:22:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:23:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:24:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:25:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:26:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:27:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:28:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:29:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:30:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:31:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:32:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:32:23 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 785 seconds, refreshing...
2025-10-03T09:32:23 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T09:33:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:34:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:35:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:36:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:37:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:37:23 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 485 seconds, refreshing...
2025-10-03T09:37:23 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T09:38:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:39:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:40:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:40:11 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T09:40:12 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 76593c67-52e1-4ab4-8aac-5c053079d008, function type: sync, timestamp (UTC): 2025-10-03 14:40:12.752563, sync threadpool max workers: 1000
2025-10-03T09:40:12 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T09:40:13 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T09:40:13 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T09:41:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:42:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:43:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:44:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:45:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:46:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:47:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:48:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:49:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:50:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:51:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:52:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:53:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:54:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:55:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:56:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:57:01 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:57:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T09:57:31 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7f9556b5-d91a-4eba-9a3c-c0d202614000'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 14:57:31 GMT'
    'Content-Length': '1753'
2025-10-03T09:57:31 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T09:57:31 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '64779eb0-93b3-481d-96cc-60c9abc72b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 14:57:31 GMT'
    'Content-Length': '7943'
2025-10-03T09:57:31 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T09:57:31 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T09:57:32 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T09:57:32 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T09:57:33 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T14:57:33","request-id":"ba0ae076-4310-4c03-95d6-ecec2519fa5c","client-request-id":"ba0ae076-4310-4c03-95d6-ecec2519fa5c
2025-10-03T09:57:33 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T09:57:33 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T09:57:33 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T14:57:33","request-id":"10cce623-3910-4bd0-aa12-cf44eeae329a","client-request-id":"10cce623-3910-4bd0-aa12-cf44eeae329a
2025-10-03T09:57:33 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T09:57:33 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T09:57:33 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T09:57:33 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T09:57:33 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T09:57:33 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T09:57:36 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T09:57:36 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T09:57:36 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T09:58:02 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:58:03 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T09:58:03 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T09:59:03 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T09:59:30 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T09:59:31 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T09:59:50 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: eb2bd90c-13ea-4eb8-b3aa-c56a7f5cacf8, function type: sync, timestamp (UTC): 2025-10-03 14:59:50.376683, sync threadpool max workers: 1000
2025-10-03T09:59:50 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T09:59:50 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T09:59:50 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T10:00:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:01:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:02:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:03:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:04:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:04:22 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: f6000f6a-999c-47e8-b740-1eff30ce32be, function type: sync, timestamp (UTC): 2025-10-03 15:04:22.467596, sync threadpool max workers: 1000
2025-10-03T10:04:22 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T10:04:28 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T10:05:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:06:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:07:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:08:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:09:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:10:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:11:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:12:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:13:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:14:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:15:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:16:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:17:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:18:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:19:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:20:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:21:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:22:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:23:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:24:04 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:25:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:26:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:27:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:27:23 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 735 seconds, refreshing...
2025-10-03T10:27:23 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T10:28:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:29:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:30:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:31:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:32:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:32:23 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 435 seconds, refreshing...
2025-10-03T10:32:23 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T10:33:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:34:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:35:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:36:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:37:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:37:23 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 608 seconds, refreshing...
2025-10-03T10:37:24 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T10:37:24 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T10:37:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T10:38:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:39:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:40:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:40:13 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T10:40:14 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: d6681628-b217-486f-822c-46434d6a6154, function type: sync, timestamp (UTC): 2025-10-03 15:40:14.010885, sync threadpool max workers: 1000
2025-10-03T10:40:14 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T10:40:14 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T10:40:14 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T10:41:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:42:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:42:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 306 seconds, refreshing...
2025-10-03T10:42:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T10:43:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:44:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:45:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:46:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:47:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:48:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:49:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:49:54 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 011094e1-edfd-441e-a096-a39c51f0a71c, function type: sync, timestamp (UTC): 2025-10-03 15:49:54.061106, sync threadpool max workers: 1000
2025-10-03T10:49:54 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T10:49:54 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T10:50:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:51:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:52:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:53:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:54:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:54:29 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a835c5d2-efee-4a12-8437-b2325c1b5728, function type: sync, timestamp (UTC): 2025-10-03 15:54:29.022787, sync threadpool max workers: 1000
2025-10-03T10:54:29 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T10:54:34 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T10:55:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:56:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:57:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:58:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:59:05 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T10:59:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T10:59:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '79d5034d-c275-4d11-ba79-b702f0fa3100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 15:59:30 GMT'
    'Content-Length': '1753'
2025-10-03T10:59:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T10:59:31 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': 'b50bee48-2a6a-47aa-a890-e6eb51202a00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 15:59:31 GMT'
    'Content-Length': '7944'
2025-10-03T10:59:31 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T10:59:31 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T10:59:32 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T10:59:32 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T10:59:32 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T15:59:33","request-id":"a24e40fb-ebca-4d8f-9a05-b2fe0640683a","client-request-id":"a24e40fb-ebca-4d8f-9a05-b2fe0640683a
2025-10-03T10:59:32 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T10:59:32 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T10:59:32 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T15:59:33","request-id":"1fe3f3f0-9b15-4cba-9272-f694dfa6bc6e","client-request-id":"1fe3f3f0-9b15-4cba-9272-f694dfa6bc6e
2025-10-03T10:59:32 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T10:59:32 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T10:59:32 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T10:59:32 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T10:59:33 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T10:59:33 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T10:59:35 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T10:59:35 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T10:59:35 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T11:00:02 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T11:00:02 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T11:00:06 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:01:07 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:01:32 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T11:01:33 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T11:02:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:03:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:04:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:05:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:06:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:07:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:08:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:09:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:10:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:11:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:12:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:13:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:14:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:15:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:16:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:17:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:18:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:19:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:20:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:21:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:22:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:23:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:24:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:25:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:26:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:27:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:28:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:29:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:30:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:31:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:32:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:33:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:34:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:35:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:36:08 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:37:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:37:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 726 seconds, refreshing...
2025-10-03T11:37:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T11:38:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:39:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:40:05 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 646ce173-878f-4400-ad10-f5ce60c4d7cc, function type: sync, timestamp (UTC): 2025-10-03 16:40:05.407973, sync threadpool max workers: 1000
2025-10-03T11:40:05 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T11:40:05 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T11:40:05 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T11:40:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:40:14 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T11:40:15 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 63f5cb98-660c-4d3f-9328-aed5d234e27f, function type: sync, timestamp (UTC): 2025-10-03 16:40:15.933005, sync threadpool max workers: 1000
2025-10-03T11:40:15 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T11:40:17 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T11:40:17 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T11:41:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:42:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:42:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 426 seconds, refreshing...
2025-10-03T11:42:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T11:43:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:44:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:44:35 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 420f6ee9-d78c-457b-a093-5b0c7a5571ed, function type: sync, timestamp (UTC): 2025-10-03 16:44:35.955288, sync threadpool max workers: 1000
2025-10-03T11:44:35 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T11:44:42 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T11:45:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:46:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:47:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:47:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 726 seconds, refreshing...
2025-10-03T11:47:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T11:48:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:49:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:50:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:51:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:52:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:52:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 426 seconds, refreshing...
2025-10-03T11:52:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T11:53:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:54:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:54:43 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T11:54:43 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T11:55:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:56:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:57:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:58:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T11:59:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:00:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:01:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:01:32 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T12:01:32 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'c5ef7c9a-ee65-479e-8de9-fbf2a7a44d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 17:01:33 GMT'
    'Content-Length': '1753'
2025-10-03T12:01:32 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T12:01:33 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '93b5680a-33d2-405a-953d-33a105ae5700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 17:01:33 GMT'
    'Content-Length': '7944'
2025-10-03T12:01:33 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T12:01:33 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T12:01:34 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T12:01:34 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T12:01:35 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T17:01:36","request-id":"b469998a-08b5-43df-8b15-c518a6bc57f6","client-request-id":"b469998a-08b5-43df-8b15-c518a6bc57f6
2025-10-03T12:01:35 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T12:01:35 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T12:01:35 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T17:01:36","request-id":"2fda5ecf-ff75-45c0-a329-66ca3416f69b","client-request-id":"2fda5ecf-ff75-45c0-a329-66ca3416f69b
2025-10-03T12:01:35 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T12:01:35 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T12:01:35 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T12:01:35 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T12:01:35 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T12:01:35 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T12:01:37 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T12:01:37 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T12:01:37 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T12:02:06 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T12:02:06 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T12:02:09 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:03:11 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:03:35 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T12:03:36 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T12:04:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:05:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:06:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:07:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:08:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:09:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:10:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:11:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:12:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:13:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:14:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:15:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:16:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:17:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:18:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:19:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:20:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:21:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:22:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:23:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:24:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:25:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:26:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:27:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:28:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:29:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:29:54 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 30ea0efa-8255-43f3-847e-9bbf313867d5, function type: sync, timestamp (UTC): 2025-10-03 17:29:54.205827, sync threadpool max workers: 1000
2025-10-03T12:29:54 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T12:29:54 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T12:30:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:31:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:32:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:33:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:34:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:34:44 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: c9a32dc7-3f7c-410f-a861-45cc3f2cf3bc, function type: sync, timestamp (UTC): 2025-10-03 17:34:44.633168, sync threadpool max workers: 1000
2025-10-03T12:34:44 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T12:34:50 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T12:35:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:36:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:37:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:37:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 848 seconds, refreshing...
2025-10-03T12:37:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T12:38:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:39:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:40:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:40:17 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T12:40:18 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 8924d7b2-af10-4847-99be-96a1cf211e85, function type: sync, timestamp (UTC): 2025-10-03 17:40:18.364497, sync threadpool max workers: 1000
2025-10-03T12:40:18 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T12:40:18 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T12:40:18 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T12:41:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:42:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:42:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 548 seconds, refreshing...
2025-10-03T12:42:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T12:42:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 763 seconds, refreshing...
2025-10-03T12:42:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T12:43:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:44:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:45:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:46:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:47:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:47:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 463 seconds, refreshing...
2025-10-03T12:47:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T12:48:12 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:49:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:50:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:51:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:52:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:53:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:54:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:54:51 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T12:54:51 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T12:55:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:56:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:57:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:58:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T12:59:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:00:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:01:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:02:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:03:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:03:35 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T13:03:36 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '7a537307-4277-45d6-9069-f08736633500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 18:03:36 GMT'
    'Content-Length': '1753'
2025-10-03T13:03:36 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T13:03:36 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '251f6eae-ca30-4662-b4db-7ca7c92a3200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 18:03:37 GMT'
    'Content-Length': '7941'
2025-10-03T13:03:36 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T13:03:36 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T13:03:37 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T13:03:37 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T13:03:38 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T18:03:39","request-id":"75727fba-5acd-451f-bbab-8d29a2e7780a","client-request-id":"75727fba-5acd-451f-bbab-8d29a2e7780a
2025-10-03T13:03:38 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T13:03:38 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T13:03:38 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T18:03:39","request-id":"0530cfb0-a1ec-4b75-91d0-c3270aa36a74","client-request-id":"0530cfb0-a1ec-4b75-91d0-c3270aa36a74
2025-10-03T13:03:38 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T13:03:38 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T13:03:38 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T13:03:38 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T13:03:38 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T13:03:38 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T13:03:41 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T13:03:41 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T13:03:41 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T13:04:08 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T13:04:08 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T13:04:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:05:13 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:05:36 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T13:05:37 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T13:06:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:07:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:08:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:09:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:10:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:11:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:12:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:13:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:14:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:15:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:16:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:17:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:18:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:19:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:20:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:20:21 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 5bee64b1-2a29-42c3-8c50-5f24f451e045, function type: sync, timestamp (UTC): 2025-10-03 18:20:21.054799, sync threadpool max workers: 1000
2025-10-03T13:20:21 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T13:20:21 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T13:20:21 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T13:21:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:22:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:23:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:24:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:24:52 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: c60f1471-9558-4c44-a0f6-81b6e94f60d7, function type: sync, timestamp (UTC): 2025-10-03 18:24:52.460264, sync threadpool max workers: 1000
2025-10-03T13:24:52 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T13:24:58 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T13:25:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:26:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:27:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:28:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:29:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:30:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:31:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:32:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:33:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:34:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:35:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:36:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:37:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:38:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:39:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:40:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:40:19 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T13:40:19 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 3896debc-c1c7-4b5c-aa33-789da5610570, function type: sync, timestamp (UTC): 2025-10-03 18:40:19.627198, sync threadpool max workers: 1000
2025-10-03T13:40:19 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T13:40:19 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T13:40:19 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T13:41:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:42:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:42:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 671 seconds, refreshing...
2025-10-03T13:42:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T13:43:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:44:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:45:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:46:14 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:47:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:47:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 371 seconds, refreshing...
2025-10-03T13:47:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T13:47:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 610 seconds, refreshing...
2025-10-03T13:47:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T13:48:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:49:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:50:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:51:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:52:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:52:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 310 seconds, refreshing...
2025-10-03T13:52:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T13:53:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:54:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:54:59 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T13:54:59 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T13:55:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:56:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:57:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:58:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T13:59:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:00:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:01:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:02:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:03:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:04:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:05:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:05:36 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T14:05:37 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '292a34f6-5298-4976-9178-5c3898363100'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 19:05:37 GMT'
    'Content-Length': '1753'
2025-10-03T14:05:37 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T14:05:37 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '6541fb38-4582-46fe-837f-817c1cb06800'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 19:05:37 GMT'
    'Content-Length': '7944'
2025-10-03T14:05:37 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T14:05:37 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T14:05:39 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T14:05:39 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T14:05:39 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T19:05:40","request-id":"aa80021d-ff70-4fa9-9fc4-f6fdb3849d7f","client-request-id":"aa80021d-ff70-4fa9-9fc4-f6fdb3849d7f
2025-10-03T14:05:39 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T14:05:39 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T14:05:39 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T19:05:40","request-id":"5e96b2bc-3cc1-41d9-940b-1ec0538c15b8","client-request-id":"5e96b2bc-3cc1-41d9-940b-1ec0538c15b8
2025-10-03T14:05:39 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T14:05:39 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T14:05:39 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T14:05:39 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T14:05:40 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T14:05:40 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T14:05:42 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T14:05:42 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T14:05:42 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T14:06:12 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T14:06:12 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T14:06:15 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:07:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:07:42 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T14:07:44 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T14:08:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:09:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:10:07 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 98e83555-b3a7-440a-8508-603e670cde72, function type: sync, timestamp (UTC): 2025-10-03 19:10:07.310969, sync threadpool max workers: 1000
2025-10-03T14:10:07 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T14:10:07 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T14:10:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:11:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:12:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:13:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:14:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:14:59 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: bf965ea4-9485-4e22-8fb8-a480cb99d726, function type: sync, timestamp (UTC): 2025-10-03 19:14:59.564260, sync threadpool max workers: 1000
2025-10-03T14:14:59 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T14:15:05 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T14:15:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:16:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:17:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:18:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:19:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:20:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:21:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:22:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:23:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:24:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:25:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:26:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:27:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:28:16 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:29:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:30:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:31:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:32:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:33:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:34:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:35:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:36:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:37:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:38:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:39:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:40:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:40:19 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T14:40:20 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 646339ba-035f-4c83-9e2b-f1871bb0c5a2, function type: sync, timestamp (UTC): 2025-10-03 19:40:20.778146, sync threadpool max workers: 1000
2025-10-03T14:40:20 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T14:40:21 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T14:40:21 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T14:41:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:42:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:42:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 792 seconds, refreshing...
2025-10-03T14:42:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T14:43:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:44:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:45:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:46:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:47:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:47:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 492 seconds, refreshing...
2025-10-03T14:47:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T14:48:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:49:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:50:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:51:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:52:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:52:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 701 seconds, refreshing...
2025-10-03T14:52:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T14:53:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:54:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:55:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:56:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:57:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:57:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 401 seconds, refreshing...
2025-10-03T14:57:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T14:58:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T14:59:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:00:14 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 4873d23d-cac0-485c-a5de-c651420ab3d6, function type: sync, timestamp (UTC): 2025-10-03 20:00:14.940942, sync threadpool max workers: 1000
2025-10-03T15:00:14 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T15:00:14 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T15:00:14 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T15:00:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:01:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:02:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:03:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:04:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:05:06 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T15:05:06 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T15:05:07 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 3160cca4-f451-4f3d-9249-f280ec51feb5, function type: sync, timestamp (UTC): 2025-10-03 20:05:07.351469, sync threadpool max workers: 1000
2025-10-03T15:05:07 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T15:05:13 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T15:05:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:06:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:07:17 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:07:42 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T15:07:43 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '8ac99b62-bad2-4329-bd12-79d499ec3b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 20:07:43 GMT'
    'Content-Length': '1753'
2025-10-03T15:07:43 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T15:07:43 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '37567b53-6a97-4246-8114-1091f59f3e00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 20:07:43 GMT'
    'Content-Length': '8053'
2025-10-03T15:07:43 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T15:07:43 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T15:07:45 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T15:07:45 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T15:07:45 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T20:07:46","request-id":"628e4a4a-6a7f-48ce-9261-5395dddb1ece","client-request-id":"628e4a4a-6a7f-48ce-9261-5395dddb1ece
2025-10-03T15:07:45 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T15:07:45 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T15:07:45 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T20:07:46","request-id":"f60d09a4-bbd4-4099-83cf-2f4da6f0bfd8","client-request-id":"f60d09a4-bbd4-4099-83cf-2f4da6f0bfd8
2025-10-03T15:07:45 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T15:07:45 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T15:07:45 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T15:07:45 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T15:07:45 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T15:07:45 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T15:07:48 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T15:07:48 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T15:07:48 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T15:08:19 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:08:19 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T15:08:19 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T15:09:19 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:09:54 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T15:09:55 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T15:10:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:11:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:12:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:13:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:14:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:15:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:16:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:17:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:18:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:19:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:20:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:21:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:22:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:23:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:24:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:25:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:26:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:27:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:28:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:29:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:30:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:31:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:32:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:33:20 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:34:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:35:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:36:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:37:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:38:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:39:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:40:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:40:21 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T15:40:22 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 01461baa-ae3a-4cfe-9270-f662d929f543, function type: sync, timestamp (UTC): 2025-10-03 20:40:22.032822, sync threadpool max workers: 1000
2025-10-03T15:40:22 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T15:40:22 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T15:40:22 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T15:41:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:42:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:43:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:44:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:45:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:46:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:47:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:47:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 618 seconds, refreshing...
2025-10-03T15:47:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T15:48:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:49:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:50:20 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 8264b58c-7d77-4816-a9d7-795fb334edf6, function type: sync, timestamp (UTC): 2025-10-03 20:50:20.160617, sync threadpool max workers: 1000
2025-10-03T15:50:20 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T15:50:20 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T15:50:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:51:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:52:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:52:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 318 seconds, refreshing...
2025-10-03T15:52:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T15:53:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:54:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:55:14 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 1b39addc-6a01-49ed-a37f-e9ab77737b01, function type: sync, timestamp (UTC): 2025-10-03 20:55:14.266217, sync threadpool max workers: 1000
2025-10-03T15:55:14 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T15:55:20 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T15:55:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:56:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:57:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:58:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T15:59:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:00:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:01:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:02:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:03:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:04:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:05:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:06:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:07:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:07:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 704 seconds, refreshing...
2025-10-03T16:07:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T16:08:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:09:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:09:54 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T16:09:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '4b934d48-813b-4420-ab0a-bb703dae0900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 21:09:55 GMT'
    'Content-Length': '1753'
2025-10-03T16:09:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T16:09:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '42d99439-d216-407a-b1c2-351a79e43500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 21:09:55 GMT'
    'Content-Length': '8053'
2025-10-03T16:09:55 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T16:09:55 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T16:09:56 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T16:09:56 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T16:09:57 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T21:09:57","request-id":"70cd75f4-a965-45bd-929f-5663cdd3b1a4","client-request-id":"70cd75f4-a965-45bd-929f-5663cdd3b1a4
2025-10-03T16:09:57 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T16:09:57 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T16:09:57 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T21:09:57","request-id":"af24e73e-3f8b-4c9c-80b9-6f85b3bbc3ce","client-request-id":"af24e73e-3f8b-4c9c-80b9-6f85b3bbc3ce
2025-10-03T16:09:57 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T16:09:57 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T16:09:57 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T16:09:57 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T16:09:57 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T16:09:57 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T16:10:00 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T16:10:00 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T16:10:00 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T16:10:21 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:10:24 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T16:10:24 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T16:11:22 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:11:55 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T16:11:56 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T16:12:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:12:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 404 seconds, refreshing...
2025-10-03T16:12:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T16:13:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:14:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:15:21 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T16:15:21 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T16:15:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:16:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:17:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:18:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:19:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:20:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:21:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:22:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:23:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:24:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:25:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:26:23 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:27:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:28:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:29:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:30:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:31:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:32:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:33:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:34:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:35:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:36:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:37:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:38:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:39:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:40:22 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T16:40:23 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: c219c54f-01fb-48d7-b3f7-7e49198cb590, function type: sync, timestamp (UTC): 2025-10-03 21:40:23.273640, sync threadpool max workers: 1000
2025-10-03T16:40:23 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T16:40:23 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T16:40:23 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T16:40:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:40:30 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 46325a5b-1434-4e7c-80dc-bcf6e394ecc5, function type: sync, timestamp (UTC): 2025-10-03 21:40:30.959326, sync threadpool max workers: 1000
2025-10-03T16:40:30 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T16:40:30 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T16:40:30 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T16:41:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:42:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:43:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:44:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:45:22 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: f4b0afce-3194-4961-9b5f-5eb16d99716d, function type: sync, timestamp (UTC): 2025-10-03 21:45:22.307178, sync threadpool max workers: 1000
2025-10-03T16:45:22 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T16:45:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:45:28 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T16:46:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:47:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:47:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 750 seconds, refreshing...
2025-10-03T16:47:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T16:48:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:49:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:50:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:51:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:52:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:52:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 450 seconds, refreshing...
2025-10-03T16:52:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T16:53:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:54:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:55:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:56:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:57:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:58:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T16:59:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:00:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:01:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:02:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:03:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:04:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:05:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:06:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:07:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:08:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:09:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:10:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:11:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:11:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T17:11:56 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': 'e819b44d-a68b-4b0e-b134-f5cb32f46b00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 22:11:56 GMT'
    'Content-Length': '1753'
2025-10-03T17:11:56 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T17:11:56 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '333f675a-04c9-46da-a457-e2d23f296500'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 22:11:56 GMT'
    'Content-Length': '8053'
2025-10-03T17:11:56 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T17:11:56 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T17:11:58 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T17:11:58 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T17:11:58 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T22:11:59","request-id":"0e6dcafe-6b91-4485-b537-e6a82bcb692c","client-request-id":"0e6dcafe-6b91-4485-b537-e6a82bcb692c
2025-10-03T17:11:58 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T17:11:58 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T17:11:58 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T22:11:59","request-id":"6415b464-5887-4be8-9ad1-3e9ad583e837","client-request-id":"6415b464-5887-4be8-9ad1-3e9ad583e837
2025-10-03T17:11:58 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T17:11:58 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T17:11:58 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T17:11:58 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T17:11:58 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T17:11:58 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T17:12:01 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T17:12:01 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T17:12:01 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T17:12:24 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:12:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 827 seconds, refreshing...
2025-10-03T17:12:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T17:12:27 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T17:12:27 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T17:13:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:13:55 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T17:13:56 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T17:14:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:15:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:16:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:17:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 527 seconds, refreshing...
2025-10-03T17:17:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T17:17:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:18:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:19:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:20:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:21:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:22:25 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:23:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:24:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:25:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:25:29 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T17:25:29 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T17:26:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:27:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:28:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:29:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:30:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:30:47 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 6ae7087d-23fc-4346-bc91-06f2679e789a, function type: sync, timestamp (UTC): 2025-10-03 22:30:47.022554, sync threadpool max workers: 1000
2025-10-03T17:30:47 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T17:30:47 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T17:31:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:32:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:33:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:34:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:35:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:35:31 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: ad5f546a-ba30-4024-8ad3-4a2dc3abcd5b, function type: sync, timestamp (UTC): 2025-10-03 22:35:31.028724, sync threadpool max workers: 1000
2025-10-03T17:35:31 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T17:35:36 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T17:36:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:37:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:38:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:39:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:40:23 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T17:40:24 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: c4aee582-0190-4968-8655-0cb057c72771, function type: sync, timestamp (UTC): 2025-10-03 22:40:24.802818, sync threadpool max workers: 1000
2025-10-03T17:40:24 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T17:40:25 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T17:40:25 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T17:40:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:41:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:42:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:43:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:44:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:45:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:46:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:47:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 871 seconds, refreshing...
2025-10-03T17:47:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T17:47:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:48:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:49:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:50:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:51:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:52:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 571 seconds, refreshing...
2025-10-03T17:52:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T17:52:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:53:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:54:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:55:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:56:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:57:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:58:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T17:59:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:00:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:01:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:02:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:03:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:04:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:05:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:06:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:07:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:08:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:09:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:10:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:11:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:12:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:13:26 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:13:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-03T18:13:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0c27fae2-f4b1-44b1-affc-877533536f00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 23:13:56 GMT'
    'Content-Length': '1753'
2025-10-03T18:13:55 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-03T18:13:56 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '89de37a6-9aa0-4057-8d9a-68ec2cca6700'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Fri, 03 Oct 2025 23:13:56 GMT'
    'Content-Length': '8052'
2025-10-03T18:13:56 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-03T18:13:56 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-03T18:13:57 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-03T18:13:57 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T18:13:58 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T23:13:58","request-id":"21a9c371-bccf-4ba7-a836-a0e1c78dd8f1","client-request-id":"21a9c371-bccf-4ba7-a836-a0e1c78dd8f1
2025-10-03T18:13:58 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-03T18:13:58 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T18:13:58 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-03T23:13:59","request-id":"451f78e7-2cac-4fab-8412-835746328c28","client-request-id":"451f78e7-2cac-4fab-8412-835746328c28
2025-10-03T18:13:58 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-03T18:13:58 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-03T18:13:58 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-03T18:13:58 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-03T18:13:58 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-03T18:13:58 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-03T18:14:00 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-03T18:14:00 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-03T18:14:00 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-03T18:14:27 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:14:27 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-03T18:14:27 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-03T18:15:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:16:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:16:54 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-03T18:16:55 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-03T18:17:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 638 seconds, refreshing...
2025-10-03T18:17:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T18:17:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:18:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:19:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:20:38 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 53e81c9e-1494-455f-a776-6cb46f9f14e7, function type: sync, timestamp (UTC): 2025-10-03 23:20:38.094553, sync threadpool max workers: 1000
2025-10-03T18:20:38 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T18:20:38 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-03T18:20:38 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T18:20:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:21:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:22:24 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 338 seconds, refreshing...
2025-10-03T18:22:24 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T18:22:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:23:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:24:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:25:38 | INFO | root | Successfully acquired user token via ROPC
2025-10-03T18:25:38 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-03T18:25:39 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 806b42d4-3744-4cc5-a69f-128621434bb8, function type: sync, timestamp (UTC): 2025-10-03 23:25:39.457714, sync threadpool max workers: 1000
2025-10-03T18:25:39 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T18:25:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:25:45 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-03T18:26:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:27:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:28:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:29:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:30:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:31:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:32:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:33:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:34:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:35:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:36:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:37:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:38:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:39:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:40:25 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-03T18:40:26 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: d4dfd1e7-5471-4b9a-a1d9-3503bd26b007, function type: sync, timestamp (UTC): 2025-10-03 23:40:26.070090, sync threadpool max workers: 1000
2025-10-03T18:40:26 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T18:40:26 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/505cd2c9-0ae4-49d0-b348-a56f181db606 "HTTP/1.1 200 OK"
2025-10-03T18:40:26 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-03T18:40:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:41:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:42:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:43:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:44:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:45:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:46:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:47:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:48:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:49:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:50:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:51:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:52:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 691 seconds, refreshing...
2025-10-03T18:52:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T18:52:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:53:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:54:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:55:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:56:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:57:24 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 391 seconds, refreshing...
2025-10-03T18:57:24 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-03T18:57:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:58:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T18:59:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:00:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:01:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:02:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:03:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:04:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:05:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:06:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:07:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:08:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:09:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:10:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:10:48 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 59052c47-36c2-4698-ab8d-27f1d4a7baee, function type: sync, timestamp (UTC): 2025-10-04 00:10:48.551274, sync threadpool max workers: 1000
2025-10-03T19:10:48 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T19:10:48 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77
2025-10-03T19:11:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:12:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:13:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:14:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:15:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=1
2025-10-03T19:15:45 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: af19348d-ef3f-43e5-9658-e5a65b47d185, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 55a53cf9-99c2-43f4-aba0-4278a687b739, function type: sync, timestamp (UTC): 2025-10-04 00:15:45.674211, sync threadpool max workers: 1000
2025-10-03T19:15:45 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-03T19:15:51 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/4d962ccc-9099-40e3-ac3e-ddcfc47bee77 "HTTP/1.1 200 OK"
2025-10-07T15:37:43 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T15:37:44 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 5e6d1f3f-45d5-415c-acf5-f5674c4f3976, function type: sync, timestamp (UTC): 2025-10-07 20:37:44.311295, sync threadpool max workers: 1000
2025-10-07T15:37:44 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T15:37:56 | INFO | __main__ | Planner sync service V5 started
2025-10-07T15:37:56 | INFO | __main__ | All services started successfully
2025-10-07T15:37:56 | INFO | __main__ | Function App: http://0.0.0.0:7071
2025-10-07T15:37:56 | INFO | __main__ | Webhook URL: https://agency-swarm.ngrok.app/api/graph_webhook
2025-10-07T15:37:56 | INFO | __main__ | Planner sync service: Running
2025-10-07T15:37:56 | INFO | __main__ | Webhooks: Configured
2025-10-07T15:37:56 | INFO | __main__ | 
==================================================
2025-10-07T15:37:56 | INFO | __main__ | All services are running.
2025-10-07T15:37:56 | INFO | __main__ | Press Ctrl+C to stop all services
2025-10-07T15:37:56 | INFO | __main__ | ==================================================

2025-10-07T15:37:56 | INFO | planner_sync_service_v5 | 🚀 Starting Webhook-Driven Planner Sync Service V5...
2025-10-07T15:37:56 | INFO | annika_task_adapter | Initialized with 1 user mappings
2025-10-07T15:37:56 | INFO | planner_sync_service_v5 | Loading existing state...
2025-10-07T15:37:56 | INFO | planner_sync_service_v5 | Loaded 240 ID mappings and 240 ETags
2025-10-07T15:37:56 | INFO | planner_sync_service_v5 | 🔗 Setting up Microsoft Graph webhooks...
2025-10-07T15:37:56 | INFO | dual_auth_manager | Dual auth config - Tenant: cb629dfe...
2025-10-07T15:37:56 | INFO | dual_auth_manager | Dual auth config - Client: fd79a94d...
2025-10-07T15:37:56 | INFO | dual_auth_manager | Dual auth config - Secret: ***
2025-10-07T15:37:56 | INFO | dual_auth_manager | ✅ Dual auth configuration validated
2025-10-07T15:37:56 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-07T15:37:57 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '9bf3d268-796c-443f-aefb-32f4b4640900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 07 Oct 2025 20:37:56 GMT'
    'Content-Length': '1753'
2025-10-07T15:37:57 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-07T15:37:57 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '123b0666-e8c6-4e6f-a637-3e0c065ad200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 07 Oct 2025 20:37:56 GMT'
    'Content-Length': '8053'
2025-10-07T15:37:57 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-07T15:37:57 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-07T15:37:57 | INFO | planner_sync_service_v5 | Planner webhooks disabled by config; skipping /planner/tasks subscriptions
2025-10-07T15:37:57 | INFO | planner_sync_service_v5 | Planner plan-scoped webhooks disabled by config; skipping per-plan subscriptions
2025-10-07T15:37:57 | INFO | httpx | HTTP Request: GET https://graph.microsoft.com/v1.0/subscriptions "HTTP/1.1 200 OK"
2025-10-07T15:37:58 | INFO | httpx | HTTP Request: GET https://graph.microsoft.com/v1.0/subscriptions "HTTP/1.1 200 OK"
2025-10-07T15:37:58 | INFO | planner_sync_service_v5 | groups webhook: no existing subscription found; creating new
2025-10-07T15:37:58 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 93067641-f9e5-435f-9796-34e9bc9477c4, function type: sync, timestamp (UTC): 2025-10-07 20:37:58.976854, sync threadpool max workers: 1000
2025-10-07T15:37:58 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T15:38:00 | INFO | httpx | HTTP Request: POST https://graph.microsoft.com/v1.0/subscriptions "HTTP/1.1 201 Created"
2025-10-07T15:38:00 | INFO | planner_sync_service_v5 | ✅ groups webhook subscription created: 9da86f47-c08a-4d0c-936b-8d26cbbec9ce
2025-10-07T15:38:00 | INFO | httpx | HTTP Request: GET https://graph.microsoft.com/v1.0/subscriptions "HTTP/1.1 200 OK"
2025-10-07T15:38:01 | INFO | httpx | HTTP Request: GET https://graph.microsoft.com/v1.0/subscriptions "HTTP/1.1 200 OK"
2025-10-07T15:38:01 | INFO | planner_sync_service_v5 | teams_chats webhook: no existing subscription found; creating new
2025-10-07T15:38:02 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 9cc10afc-5229-4c01-9aec-4336077d3ed9, function type: sync, timestamp (UTC): 2025-10-07 20:38:02.336349, sync threadpool max workers: 1000
2025-10-07T15:38:02 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T15:38:08 | INFO | httpx | HTTP Request: POST https://graph.microsoft.com/v1.0/subscriptions "HTTP/1.1 201 Created"
2025-10-07T15:38:08 | INFO | planner_sync_service_v5 | ✅ teams_chats webhook subscription created: 016f91c2-9b5d-4eda-988d-b9b97deb9c67
2025-10-07T15:38:09 | INFO | httpx | HTTP Request: GET https://graph.microsoft.com/v1.0/subscriptions "HTTP/1.1 200 OK"
2025-10-07T15:38:09 | INFO | httpx | HTTP Request: GET https://graph.microsoft.com/v1.0/subscriptions "HTTP/1.1 200 OK"
2025-10-07T15:38:09 | INFO | planner_sync_service_v5 | teams_channels webhook: no existing subscription found; creating new
2025-10-07T15:38:10 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: bfdd959f-e2b4-4537-9070-03af828a3253, function type: sync, timestamp (UTC): 2025-10-07 20:38:10.044487, sync threadpool max workers: 1000
2025-10-07T15:38:10 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T15:38:16 | INFO | httpx | HTTP Request: POST https://graph.microsoft.com/v1.0/subscriptions "HTTP/1.1 201 Created"
2025-10-07T15:38:16 | INFO | planner_sync_service_v5 | ✅ teams_channels webhook subscription created: 898fc575-cc24-44b3-b2b4-f9449117cc62
2025-10-07T15:38:16 | INFO | httpx | HTTP Request: GET https://graph.microsoft.com/v1.0/subscriptions/9da86f47-c08a-4d0c-936b-8d26cbbec9ce "HTTP/1.1 200 OK"
2025-10-07T15:38:16 | INFO | planner_sync_service_v5 | webhook 'groups' in use: id=9da86f47-c08a-4d0c-936b-8d26cbbec9ce resource=/groups expires=2025-10-08T20:37:57.355262Z
2025-10-07T15:38:17 | INFO | httpx | HTTP Request: GET https://graph.microsoft.com/v1.0/subscriptions/016f91c2-9b5d-4eda-988d-b9b97deb9c67 "HTTP/1.1 200 OK"
2025-10-07T15:38:17 | INFO | planner_sync_service_v5 | webhook 'teams_chats' in use: id=016f91c2-9b5d-4eda-988d-b9b97deb9c67 resource=/chats expires=2025-10-08T20:37:57.355262Z
2025-10-07T15:38:18 | INFO | httpx | HTTP Request: GET https://graph.microsoft.com/v1.0/subscriptions/898fc575-cc24-44b3-b2b4-f9449117cc62 "HTTP/1.1 200 OK"
2025-10-07T15:38:18 | INFO | planner_sync_service_v5 | webhook 'teams_channels' in use: id=898fc575-cc24-44b3-b2b4-f9449117cc62 resource=/teams/getAllChannels expires=2025-10-08T20:37:57.355262Z
2025-10-07T15:38:45 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-07T15:38:45 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-07T15:40:08 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 15 groups, 27 plans, 61 buckets (page 1)
2025-10-07T15:40:08 | INFO | planner_sync_service_v5 | 🔄 Performing minimal initial sync...
2025-10-07T15:40:08 | INFO | planner_sync_service_v5 | Found 252 recently modified tasks to sync
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 | 🔍 Performing immediate Planner poll as part of initial sync...
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 | Using application token for Planner reads
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-07T15:40:09 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-07T20:40:09","request-id":"4b67e6a0-79f8-4a67-b505-76efa474416d","client-request-id":"4b67e6a0-79f8-4a67-b505-76efa474416d
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-07T15:40:09 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-07T20:40:09","request-id":"684525d1-0f01-4582-b756-a933a14e7012","client-request-id":"684525d1-0f01-4582-b756-a933a14e7012
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-07T15:40:09 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-07T15:40:09 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-07T15:40:11 | INFO | planner_sync_service_v5 | 📤 Processing upload batch of 10 tasks
2025-10-07T15:40:21 | ERROR | planner_sync_service_v5 | Error creating Planner task: HTTPSConnectionPool(host='graph.microsoft.com', port=443): Read timed out. (read timeout=10)
2025-10-07T15:40:21 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-07T15:40:21 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-07T15:40:21 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-07T15:40:21 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id KPq4cedxekWOVx9O8BEpymUAFQ3o
2025-10-07T15:40:22 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id 0R2cTWN2lk601qPlrwqGJmUAFx4w
2025-10-07T15:40:22 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id KlzOIWuickypGCdy3wceL2UAPFfA
2025-10-07T15:40:23 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id GXdqAFFx10-TZLWLG73mnGUAFpfg
2025-10-07T15:40:23 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id y8If92Xb3kiAtAVxJxucNWUAPhz2
2025-10-07T15:40:24 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id l0aS_x-cSUKyMVVTRzJjIGUAJG8E
2025-10-07T15:40:24 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id omtTW8pCFkGpoM9xYhixaGUAOsY-
2025-10-07T15:40:24 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id vxzBSFtmeU-gJInizMNJs2UADzrG
2025-10-07T15:40:25 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id QeKAUPhAb0mY6wClJWwmxWUAJCZb
2025-10-07T15:40:29 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-07T15:40:29 | INFO | planner_sync_service_v5 | ✅ Initial sync completed
2025-10-07T15:40:29 | INFO | planner_sync_service_v5 | 📤 Monitoring Annika changes for upload...
2025-10-07T15:40:29 | INFO | planner_sync_service_v5 | 📥 Monitoring webhook notifications...
2025-10-07T15:40:29 | INFO | planner_sync_service_v5 | ⏰ Starting Planner polling loop (every 3600s)
2025-10-07T15:40:34 | INFO | planner_sync_service_v5 | 📤 Processing upload batch of 2 tasks
2025-10-07T15:40:34 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id _OGX09o-5UW9iBV7R4CFN2UAGAzv
2025-10-07T15:40:34 | INFO | planner_sync_service_v5 | 🔁 Planner create short-circuited to update for existing external_id CKaKv-I37Ey8SJP_JiOgvmUAGfFN
2025-10-07T15:41:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:42:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:43:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:44:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:45:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:46:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:47:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:48:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:49:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:50:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:51:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:52:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:53:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:54:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:55:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:56:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:57:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:58:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T15:59:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:00:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:01:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:02:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:03:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:04:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:05:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:06:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:07:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:08:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:09:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:10:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:11:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:12:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:13:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:14:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:15:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:16:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:17:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:17:42 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 615 seconds, refreshing...
2025-10-07T16:17:42 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-07T16:18:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:19:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:20:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:21:29 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:22:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:22:42 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 315 seconds, refreshing...
2025-10-07T16:22:42 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-07T16:23:27 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a513a27e-0561-4afe-bfca-be7e25d51346, function type: sync, timestamp (UTC): 2025-10-07 21:23:27.787169, sync threadpool max workers: 1000
2025-10-07T16:23:27 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 036dc7c5-5a80-4e6a-9cdd-687fdbfe57fa
2025-10-07T16:23:27 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-07T16:23:27 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/036dc7c5-5a80-4e6a-9cdd-687fdbfe57fa
2025-10-07T16:23:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:24:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:25:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:26:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:27:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:27:51 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 3ef7063c-317a-437b-a2b3-0375d493c470, function type: sync, timestamp (UTC): 2025-10-07 21:27:51.739145, sync threadpool max workers: 1000
2025-10-07T16:27:51 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T16:27:58 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/036dc7c5-5a80-4e6a-9cdd-687fdbfe57fa "HTTP/1.1 200 OK"
2025-10-07T16:28:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:29:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:30:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:31:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:32:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:32:42 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 701 seconds, refreshing...
2025-10-07T16:32:42 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-07T16:33:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:34:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:35:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:36:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:37:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:37:42 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 401 seconds, refreshing...
2025-10-07T16:37:42 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-07T16:38:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:39:30 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:40:29 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-07T16:40:30 | INFO | root | Successfully acquired user token via ROPC
2025-10-07T16:40:30 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-07T16:40:30 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-07T16:40:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-07T16:40:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '2f2d6a1f-b22c-4c84-8f77-99511c510900'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 07 Oct 2025 21:40:30 GMT'
    'Content-Length': '1753'
2025-10-07T16:40:30 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-07T16:40:31 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '643199bb-840c-4cbe-9f82-1d862289a200'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 07 Oct 2025 21:40:30 GMT'
    'Content-Length': '8052'
2025-10-07T16:40:31 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-07T16:40:31 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-07T16:40:31 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-07T16:40:31 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-07T21:40:31","request-id":"9ab5a02c-94c0-4152-888f-ec4529e35aff","client-request-id":"9ab5a02c-94c0-4152-888f-ec4529e35aff
2025-10-07T16:40:31 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-07T16:40:31 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-07T16:40:31 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-07T21:40:31","request-id":"e310fbe7-b2d1-4205-9632-2005ea1b2ddc","client-request-id":"e310fbe7-b2d1-4205-9632-2005ea1b2ddc
2025-10-07T16:40:31 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-07T16:40:31 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-07T16:40:31 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-07T16:40:31 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-07T16:40:31 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-07T16:40:31 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-07T16:40:34 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-07T16:40:34 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-07T16:40:34 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-07T16:40:36 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:40:37 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 04d35eb9-05cf-4298-9954-a19fbf8a740a, function type: sync, timestamp (UTC): 2025-10-07 21:40:37.549770, sync threadpool max workers: 1000
2025-10-07T16:40:37 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T16:40:38 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/9da86f47-c08a-4d0c-936b-8d26cbbec9ce "HTTP/1.1 200 OK"
2025-10-07T16:40:38 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-07T16:40:41 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a4e79b9d-1e9b-4ef5-aa7d-7d94b1f3f340, function type: sync, timestamp (UTC): 2025-10-07 21:40:41.593937, sync threadpool max workers: 1000
2025-10-07T16:40:41 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T16:40:47 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/016f91c2-9b5d-4eda-988d-b9b97deb9c67 "HTTP/1.1 200 OK"
2025-10-07T16:40:47 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: teams_chats
2025-10-07T16:40:50 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 15548dc1-00f2-4c4d-9fe5-ca418acca529, function type: sync, timestamp (UTC): 2025-10-07 21:40:50.912747, sync threadpool max workers: 1000
2025-10-07T16:40:50 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T16:40:57 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/898fc575-cc24-44b3-b2b4-f9449117cc62 "HTTP/1.1 200 OK"
2025-10-07T16:40:57 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: teams_channels
2025-10-07T16:40:58 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-07T16:40:58 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-07T16:41:37 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:42:10 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-07T16:42:11 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-07T16:42:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:43:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:44:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:45:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:46:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:47:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:48:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:49:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:50:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:51:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:52:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:53:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:54:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:55:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:56:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:57:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:58:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T16:59:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:00:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:01:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:02:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:03:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:04:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:05:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:06:38 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:07:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:08:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:09:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:10:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:11:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:12:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:13:17 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 36fed80a-1105-4100-955e-790149fc98b5, function type: sync, timestamp (UTC): 2025-10-07 22:13:17.510556, sync threadpool max workers: 1000
2025-10-07T17:13:17 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 036dc7c5-5a80-4e6a-9cdd-687fdbfe57fa
2025-10-07T17:13:17 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/036dc7c5-5a80-4e6a-9cdd-687fdbfe57fa
2025-10-07T17:13:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:14:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:15:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:16:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:17:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:17:42 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 769 seconds, refreshing...
2025-10-07T17:17:42 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-07T17:17:59 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 6770e32b-0128-4996-9489-f717702e387d, function type: sync, timestamp (UTC): 2025-10-07 22:17:59.260223, sync threadpool max workers: 1000
2025-10-07T17:17:59 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T17:18:05 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/036dc7c5-5a80-4e6a-9cdd-687fdbfe57fa "HTTP/1.1 200 OK"
2025-10-07T17:18:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:19:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:20:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:21:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:22:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:22:42 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 469 seconds, refreshing...
2025-10-07T17:22:42 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-07T17:23:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:24:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:25:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:26:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:27:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:28:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:29:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:30:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:31:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:32:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:33:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:34:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:35:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:36:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:37:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:38:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:39:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:40:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:40:57 | INFO | planner_sync_service_v5 | 🔄 Renewing webhook subscriptions...
2025-10-07T17:40:58 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 75c4c257-0869-4c3c-9cb2-1161d846a7cf, function type: sync, timestamp (UTC): 2025-10-07 22:40:58.920280, sync threadpool max workers: 1000
2025-10-07T17:40:58 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T17:41:00 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/9da86f47-c08a-4d0c-936b-8d26cbbec9ce "HTTP/1.1 200 OK"
2025-10-07T17:41:00 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: groups
2025-10-07T17:41:00 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/v2.0/.well-known/openid-configuration'
Request method: 'GET'
Request headers:
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
No body was attached to the request
2025-10-07T17:41:00 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'max-age=86400, private'
    'Content-Type': 'application/json; charset=utf-8'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'Access-Control-Allow-Origin': 'REDACTED'
    'Access-Control-Allow-Methods': 'REDACTED'
    'P3P': 'REDACTED'
    'x-ms-request-id': '0e5ca6ae-6fe6-4f3e-ab91-cac2604dbd00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 07 Oct 2025 22:41:00 GMT'
    'Content-Length': '1753'
2025-10-07T17:41:00 | INFO | azure.core.pipeline.policies.http_logging_policy | Request URL: 'https://login.microsoftonline.com/cb629dfe-9f7b-497f-b0d2-502dd53d8227/oauth2/v2.0/token'
Request method: 'POST'
Request headers:
    'Accept': 'application/json'
    'x-client-sku': 'REDACTED'
    'x-client-ver': 'REDACTED'
    'x-client-os': 'REDACTED'
    'x-ms-lib-capability': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-client-current-telemetry': 'REDACTED'
    'x-client-last-telemetry': 'REDACTED'
    'User-Agent': 'azsdk-python-identity/1.25.0 Python/3.11.13 (Windows-10-10.0.26220-SP0)'
A body is sent with the request
2025-10-07T17:41:00 | INFO | azure.core.pipeline.policies.http_logging_policy | Response status: 200
Response headers:
    'Cache-Control': 'no-store, no-cache'
    'Pragma': 'no-cache'
    'Content-Type': 'application/json; charset=utf-8'
    'Expires': '-1'
    'Strict-Transport-Security': 'REDACTED'
    'X-Content-Type-Options': 'REDACTED'
    'P3P': 'REDACTED'
    'client-request-id': 'REDACTED'
    'x-ms-request-id': '85cea6a2-c118-45ca-a8b9-61bd7f2b0d00'
    'x-ms-ests-server': 'REDACTED'
    'x-ms-clitelem': 'REDACTED'
    'x-ms-srs': 'REDACTED'
    'Content-Security-Policy-Report-Only': 'REDACTED'
    'Cross-Origin-Opener-Policy-Report-Only': 'REDACTED'
    'Reporting-Endpoints': 'REDACTED'
    'X-XSS-Protection': 'REDACTED'
    'Set-Cookie': 'REDACTED'
    'Date': 'Tue, 07 Oct 2025 22:41:00 GMT'
    'Content-Length': '8052'
2025-10-07T17:41:00 | INFO | azure.identity._internal.get_token_mixin | ClientSecretCredential.get_token succeeded
2025-10-07T17:41:00 | INFO | mcp_redis_config | Token stored successfully for scope: application:https://graph.microsoft.com/.default
2025-10-07T17:41:02 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: bdc8bb0a-6f96-4bcf-b9ab-f6b1ef072859, function type: sync, timestamp (UTC): 2025-10-07 22:41:02.057347, sync threadpool max workers: 1000
2025-10-07T17:41:02 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T17:41:08 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/016f91c2-9b5d-4eda-988d-b9b97deb9c67 "HTTP/1.1 200 OK"
2025-10-07T17:41:08 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: teams_chats
2025-10-07T17:41:09 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: 699449db-4f10-4f01-90c8-a5b8352af289, function type: sync, timestamp (UTC): 2025-10-07 22:41:09.886716, sync threadpool max workers: 1000
2025-10-07T17:41:09 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T17:41:15 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/898fc575-cc24-44b3-b2b4-f9449117cc62 "HTTP/1.1 200 OK"
2025-10-07T17:41:15 | INFO | planner_sync_service_v5 | ✅ Renewed webhook: teams_channels
2025-10-07T17:41:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:42:11 | INFO | planner_sync_service_v5 | 🔍 Starting hourly Planner poll for task changes...
2025-10-07T17:42:11 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-07T17:42:12 | WARNING | planner_sync_service_v5 | Failed to get personal plans: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-07T22:42:12","request-id":"21640edd-4150-408c-941a-b6f82f529d73","client-request-id":"21640edd-4150-408c-941a-b6f82f529d73
2025-10-07T17:42:12 | INFO | planner_sync_service_v5 |    Found 0 personal plans
2025-10-07T17:42:12 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-07T17:42:12 | WARNING | planner_sync_service_v5 | Failed to get group memberships: 400 - {"error":{"code":"BadRequest","message":"/me request is only valid with delegated authentication flow.","innerError":{"date":"2025-10-07T22:42:12","request-id":"2f61a668-e4d8-435e-9987-1658523232a9","client-request-id":"2f61a668-e4d8-435e-9987-1658523232a9
2025-10-07T17:42:12 | INFO | planner_sync_service_v5 |    No group memberships returned
2025-10-07T17:42:12 | INFO | planner_sync_service_v5 | ?? Total plans found: 0
2025-10-07T17:42:12 | WARNING | planner_sync_service_v5 | Application token returned no plans; retrying with delegated fallback
2025-10-07T17:42:12 | INFO | planner_sync_service_v5 | ?? Getting personal plans...
2025-10-07T17:42:12 | INFO | planner_sync_service_v5 |    Found 1 personal plans
2025-10-07T17:42:12 | INFO | planner_sync_service_v5 | ?? Getting group memberships...
2025-10-07T17:42:14 | INFO | planner_sync_service_v5 |    Found 22 plans across 5 groups
2025-10-07T17:42:14 | INFO | planner_sync_service_v5 | ?? Total plans found: 23
2025-10-07T17:42:14 | INFO | planner_sync_service_v5 | 📋 Polling 23 Planner plans for task changes
2025-10-07T17:42:36 | INFO | graph_metadata_manager | Cached 38 users in Redis
2025-10-07T17:42:36 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 38 users
2025-10-07T17:42:39 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:43:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:43:51 | INFO | planner_sync_service_v5 | Metadata prewarm: cached 16 groups, 30 plans, 61 buckets (page 1)
2025-10-07T17:43:52 | INFO | planner_sync_service_v5 | ✅ Planner polling complete: 240 tasks checked, 0 created, 0 updated
2025-10-07T17:44:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:45:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:46:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:47:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:47:42 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 709 seconds, refreshing...
2025-10-07T17:47:42 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-07T17:48:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:49:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:50:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:51:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:52:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:52:42 | INFO | token_refresh_service | Token for scope 'Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile' expiring in 409 seconds, refreshing...
2025-10-07T17:52:42 | INFO | token_refresh_service | Successfully refreshed token for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-07T17:53:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:54:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:55:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:56:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:57:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:58:05 | INFO | root | Successfully acquired user token via ROPC
2025-10-07T17:58:05 | INFO | mcp_redis_config | Token stored successfully for scope: Bookings.Manage.All Bookings.ReadWrite.All Calendars.ReadWrite.Shared ChannelMessage.ReadWrite ChannelMessage.Send Chat.Create Chat.ManageDeletion.All ChatMember.ReadWrite ChatMessage.Read ChatMessage.Send Community.ReadWrite.All EWS.AccessAsUser.All FileStorageContainer.Selected Files.ReadWrite.All Files.ReadWrite.AppFolder Files.ReadWrite.Selected Files.SelectedOperations.Selected Goals-Export.ReadWrite.All Group.ReadWrite.All GroupMember.ReadWrite.All IMAP.AccessAsUser.All Mail-Advanced.ReadWrite.Shared Mail.ReadWrite Mail.ReadWrite.Shared Mail.Send Mail.Send.Shared MailboxFolder.ReadWrite MailboxItem.ImportExport MailboxItem.Read MailboxSettings.ReadWrite ManagedTenants.ReadWrite.All Notes.Create Notes.ReadWrite.All POP.AccessAsUser.All People.Read.All PeopleSettings.ReadWrite.All Place.ReadWrite.All PlaceDevice.ReadWrite.All SMTP.Send SecurityActions.ReadWrite.All SecurityAlert.ReadWrite.All SecurityAnalyzedMessage.ReadWrite.All SecurityEvents.ReadWrite.All Sites.FullControl.All Sites.Manage.All Sites.ReadWrite.All Sites.Selected Subscription.Read.All Tasks.ReadWrite Tasks.ReadWrite.Shared Team.Create TeamMember.ReadWrite.All TeamMember.ReadWriteNonOwnerRole.All TeamSettings.Read.All TeamSettings.ReadWrite.All TeamTemplates.Read TeamsActivity.Read TeamsActivity.Send TeamsAppInstallation.ReadWriteAndConsentForChat TeamsAppInstallation.ReadWriteAndConsentForTeam TeamsAppInstallation.ReadWriteAndConsentForUser TeamsAppInstallation.ReadWriteForChat TeamsAppInstallation.ReadWriteForTeam TeamsAppInstallation.ReadWriteForUser TeamsAppInstallation.ReadWriteSelfForChat TeamsAppInstallation.ReadWriteSelfForTeam TeamsAppInstallation.ReadWriteSelfForUser TeamsTab.Create TeamsTab.Read.All TeamsTab.ReadWrite.All TeamsTab.ReadWriteForChat TeamsTab.ReadWriteForTeam TeamsTab.ReadWriteForUser TeamsUserConfiguration.Read.All Teamwork.Read.All TeamworkAppSettings.ReadWrite.All TeamworkDevice.ReadWrite.All TeamworkTag.ReadWrite TeamworkUserInteraction.Read.All TermStore.ReadWrite.All ThreatAssessment.ReadWrite.All User.Read User.ReadBasic.All User.ReadWrite.All UserTeamwork.Read UserTimelineActivity.Write.CreatedByApp VirtualAppointment.ReadWrite VirtualAppointmentNotification.Send VirtualEvent.ReadWrite email offline_access openid profile
2025-10-07T17:58:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T17:59:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:00:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:01:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:02:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:03:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:04:19 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: fc3de0a4-eb9e-4c1c-acee-6e988d4cb895, function type: sync, timestamp (UTC): 2025-10-07 23:04:19.960841, sync threadpool max workers: 1000
2025-10-07T18:04:19 | INFO | webhook_handler | 🔔 Lifecycle event 'reauthorizationRequired' for subscription 036dc7c5-5a80-4e6a-9cdd-687fdbfe57fa
2025-10-07T18:04:19 | ERROR | webhook_handler | Error logging webhook notification: Event loop is closed
2025-10-07T18:04:19 | INFO | endpoints.agent_webhook | Successfully processed webhook notification: None for Subscriptions/036dc7c5-5a80-4e6a-9cdd-687fdbfe57fa
2025-10-07T18:04:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:05:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:06:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:07:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:08:06 | INFO | azure_functions_worker | Received FunctionInvocationRequest, request ID: 54653a0b-c1f1-44ee-a435-fb0e0a9e688d, function ID: a9cad05f-00be-512b-b317-e8939ff77875, function name: graph_webhook_http, invocation ID: a09bce4c-6755-4ffd-8f20-5e493556dcca, function type: sync, timestamp (UTC): 2025-10-07 23:08:06.550907, sync threadpool max workers: 1000
2025-10-07T18:08:06 | INFO | endpoints.agent_webhook | Graph webhook validation request received
2025-10-07T18:08:12 | INFO | httpx | HTTP Request: PATCH https://graph.microsoft.com/v1.0/subscriptions/036dc7c5-5a80-4e6a-9cdd-687fdbfe57fa "HTTP/1.1 200 OK"
2025-10-07T18:08:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:09:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:10:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:11:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:12:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:13:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:14:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:15:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:16:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:17:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:17:42 | INFO | token_refresh_service | Token for scope 'application:https://graph.microsoft.com/.default' expiring in 798 seconds, refreshing...
2025-10-07T18:17:42 | INFO | token_refresh_service | Successfully refreshed token for scope: application:https://graph.microsoft.com/.default
2025-10-07T18:18:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:19:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:20:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:21:40 | INFO | planner_sync_service_v5 | 📊 Health Check: processed=240 pending=0 failed=0 rate=ok webhooks=3
2025-10-07T18:21:53 | INFO | __main__ | 
Shutdown signal received...
2025-10-07T18:21:53 | INFO | __main__ | 
Cleaning up...
2025-10-07T18:21:53 | INFO | __main__ | 
Stopping all services...
2025-10-07T18:21:53 | INFO | __main__ | Stopping Planner sync service V5...
2025-10-07T18:21:53 | INFO | planner_sync_service_v5 | 🧹 Cleaning up webhooks...
2025-10-07T18:21:54 | INFO | httpx | HTTP Request: DELETE https://graph.microsoft.com/v1.0/subscriptions/9da86f47-c08a-4d0c-936b-8d26cbbec9ce "HTTP/1.1 204 No Content"
2025-10-07T18:21:54 | INFO | planner_sync_service_v5 | ✅ Cleaned up webhook: groups
2025-10-07T18:21:55 | INFO | httpx | HTTP Request: DELETE https://graph.microsoft.com/v1.0/subscriptions/016f91c2-9b5d-4eda-988d-b9b97deb9c67 "HTTP/1.1 404 Not Found"
2025-10-07T18:21:55 | WARNING | planner_sync_service_v5 | Failed to cleanup webhook teams_chats: 404
2025-10-07T18:21:57 | INFO | httpx | HTTP Request: DELETE https://graph.microsoft.com/v1.0/subscriptions/898fc575-cc24-44b3-b2b4-f9449117cc62 "HTTP/1.1 404 Not Found"
2025-10-07T18:21:57 | WARNING | planner_sync_service_v5 | Failed to cleanup webhook teams_channels: 404
2025-10-07T18:21:57 | INFO | planner_sync_service_v5 | Webhook-driven sync service stopped
2025-10-07T18:21:57 | INFO | __main__ | Planner sync service V5 stopped.
2025-10-07T18:21:57 | INFO | __main__ | Stopping ngrok...
2025-10-07T18:21:57 | INFO | __main__ | ngrok stopped.
2025-10-07T18:21:57 | INFO | __main__ | Stopping Azure Function App...
2025-10-07T18:21:59 | INFO | __main__ | Function App stopped.
2025-10-07T18:22:04 | INFO | __main__ | All services stopped.
2025-10-07T18:22:05 | INFO | __main__ | 
Goodbye!
